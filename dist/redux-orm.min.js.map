{"version":3,"sources":["webpack://ReduxOrm/webpack/universalModuleDefinition","webpack://ReduxOrm/webpack/bootstrap","webpack://ReduxOrm/./node_modules/@babel/runtime/helpers/createClass.js","webpack://ReduxOrm/./node_modules/@babel/runtime/helpers/inheritsLoose.js","webpack://ReduxOrm/./node_modules/@babel/runtime/helpers/typeof.js","webpack://ReduxOrm/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://ReduxOrm/./node_modules/lodash/_baseIteratee.js","webpack://ReduxOrm/./node_modules/lodash/mapValues.js","webpack://ReduxOrm/./node_modules/lodash/isArray.js","webpack://ReduxOrm/./node_modules/lodash/_baseOrderBy.js","webpack://ReduxOrm/./node_modules/lodash/identity.js","webpack://ReduxOrm/./node_modules/lodash/reject.js","webpack://ReduxOrm/./node_modules/lodash/filter.js","webpack://ReduxOrm/./node_modules/lodash/orderBy.js","webpack://ReduxOrm/./node_modules/lodash/sortBy.js","webpack://ReduxOrm/./node_modules/reselect/lib/index.js","webpack://ReduxOrm/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://ReduxOrm/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://ReduxOrm/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://ReduxOrm/./node_modules/lodash/_arrayFilter.js","webpack://ReduxOrm/./node_modules/lodash/_baseFilter.js","webpack://ReduxOrm/./node_modules/lodash/negate.js","webpack://ReduxOrm/./node_modules/lodash/_arrayMap.js","webpack://ReduxOrm/./node_modules/lodash/_baseMap.js","webpack://ReduxOrm/./node_modules/lodash/_baseSortBy.js","webpack://ReduxOrm/./node_modules/lodash/_baseUnary.js","webpack://ReduxOrm/./node_modules/lodash/_compareMultiple.js","webpack://ReduxOrm/./node_modules/lodash/_compareAscending.js","webpack://ReduxOrm/./node_modules/lodash/isSymbol.js","webpack://ReduxOrm/./node_modules/lodash/_baseFlatten.js","webpack://ReduxOrm/./node_modules/lodash/_baseRest.js","webpack://ReduxOrm/./node_modules/lodash/_overRest.js","webpack://ReduxOrm/./node_modules/lodash/_apply.js","webpack://ReduxOrm/./node_modules/lodash/_setToString.js","webpack://ReduxOrm/./node_modules/lodash/_isIterateeCall.js","webpack://ReduxOrm/./node_modules/lodash/_baseAssignValue.js","webpack://ReduxOrm/./node_modules/lodash/_defineProperty.js","webpack://ReduxOrm/./node_modules/lodash/_getNative.js","webpack://ReduxOrm/./node_modules/lodash/_baseForOwn.js","webpack://ReduxOrm/./node_modules/lodash/_baseFor.js","webpack://ReduxOrm/./node_modules/lodash/_createBaseFor.js","webpack://ReduxOrm/./node_modules/lodash/keys.js","webpack://ReduxOrm/./node_modules/lodash/_overArg.js","webpack://ReduxOrm/./node_modules/ramda/es/internal/_isPlaceholder.js","webpack://ReduxOrm/./node_modules/ramda/es/internal/_curry1.js","webpack://ReduxOrm/./node_modules/ramda/es/internal/_arity.js","webpack://ReduxOrm/./node_modules/ramda/es/curryN.js","webpack://ReduxOrm/./node_modules/ramda/es/internal/_curry2.js","webpack://ReduxOrm/./node_modules/ramda/es/internal/_curryN.js","webpack://ReduxOrm/./node_modules/ramda/es/curry.js","webpack://ReduxOrm/./node_modules/ramda/es/__.js","webpack://ReduxOrm/./node_modules/immutable-ops/es/index.js","webpack://ReduxOrm/./src/constants.js","webpack://ReduxOrm/./src/utils.js","webpack://ReduxOrm/./src/QuerySet.js","webpack://ReduxOrm/./src/Session.js","webpack://ReduxOrm/./src/descriptors.js","webpack://ReduxOrm/./src/fields.js","webpack://ReduxOrm/./src/Model.js","webpack://ReduxOrm/./src/db/Table.js","webpack://ReduxOrm/./src/db/Database.js","webpack://ReduxOrm/./src/memoize.js","webpack://ReduxOrm/./src/redux.js","webpack://ReduxOrm/./src/ORM.js","webpack://ReduxOrm/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_defineProperties","target","props","length","descriptor","configurable","writable","Constructor","protoProps","staticProps","subClass","superClass","constructor","__proto__","_typeof2","obj","iterator","_typeof","arrayWithoutHoles","iterableToArray","nonIterableSpread","arr","baseAssignValue","baseForOwn","baseIteratee","iteratee","result","isArray","Array","arrayMap","baseMap","baseSortBy","baseUnary","compareMultiple","identity","collection","iteratees","orders","index","criteria","other","arrayFilter","baseFilter","negate","predicate","array","resIndex","baseOrderBy","guard","undefined","baseFlatten","baseRest","isIterateeCall","sortBy","defaultEqualityCheck","a","b","defaultMemoize","func","equalityCheck","arguments","lastArgs","lastResult","prev","next","areArgumentsShallowlyEqual","apply","createSelectorCreator","memoize","_len","memoizeOptions","_key","_len2","funcs","_key2","recomputations","resultFunc","pop","dependencies","every","dep","dependencyTypes","map","join","Error","getDependencies","memoizedResultFunc","concat","selector","params","push","resetRecomputations","createStructuredSelector","selectors","selectorCreator","createSelector","objectKeys","keys","_len3","values","_key3","reduce","composition","arr2","iter","toString","from","TypeError","FUNC_ERROR_TEXT","args","this","comparer","sort","compareAscending","objCriteria","othCriteria","ordersLength","isSymbol","valIsDefined","valIsNull","valIsReflexive","valIsSymbol","othIsDefined","othIsNull","othIsReflexive","othIsSymbol","overRest","setToString","start","nativeMax","Math","max","transform","otherArgs","thisArg","getNative","e","baseFor","createBaseFor","fromRight","keysFunc","iterable","nativeKeys","overArg","arg","_isPlaceholder","_curry1","fn","f1","_arity","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","es_curryN","f2","_b","_a","_curry2","_curryN","received","combined","argsIdx","left","combinedIdx","es_curry","_","@@functional/placeholder","forOwn","OWNER_ID_TAG","canMutate","ownerID","getBatchToken","prepareNewObject","instance","addOwnerID","forceArray","PATH_SEPARATOR","normalizePath","pathArg","indexOf","split","mutableSet","mutableMerge","isDeep","_mergeObjs","baseObj","mergeObjs","forEach","mergeObj","assignValue","typeof_default","assign","toConsumableArray_default","mutableShallowMerge","mutableDeepMerge","mutableOmit","_keys","shouldMergeKey","immutableMerge","hasChanges","nextObject","willChange","mergeValue","currentValue","recursiveMergeResult","immutableDeepMerge","immutableArrSet","newArr","copied","fastArrayCopy","mutableArrFilter","currIndex","originalIndex","splice","mutableArrSplice","deleteCount","_vals","vals","mutableArrInsert","immutableArrSplice","slice","immutableArrInsert","immutableOperations","merge","deepMerge","omit","keysInObj","filter","newObj","setIn","_pathArg","acc","currRef","valueInPath","pathLen","rootObj","curr","idx","currType","_newObj","pathRepr","insert","set","isArrayLike","mutableOperations","originalPathArg","done","es","immutableOps","mutableOps","batchOps","mutable","batch","batched","_token","_fn","token","immutableOpsBoundToToken","__","getImmutableOps","UPDATE","DELETE","CREATE","FILTER","EXCLUDE","SUCCESS","warnDeprecated","msg","console","warn","log","m2mName","declarationModelName","fieldName","string","charAt","toUpperCase","capitalize","m2mFromFieldName","m2mToFieldName","otherModelName","querySetDelegatorFactory","methodName","getQuerySet","querySetGetterDelegatorFactory","getterName","attachQuerySetMethods","modelClass","querySetClass","leftToDefine","sharedMethods","currClass","Function","getPrototypeOf","forEachSuperClass","cls","defined","getOwnPropertyDescriptor","normalizeEntity","entity","getId","arrayDiffActions","sourceArr","targetArr","itemsInBoth","item","includes","deleteItems","addItems","delete","add","ops","clauseFiltersByAttribute","type","payload","attribute","attributeValue","QuerySet","clauses","opts","_opts","addSharedMethod","_proto","_new","userOpts","_evaluate","rows","id","withId","toRefArray","toModelArray","ModelClass","count","exists","Boolean","at","first","last","all","lookupObj","normalizedLookupObj","mapValues","filterDescriptor","exclude","excludeDescriptor","session","modelName","_evaluated","table","querySpec","query","orderBy","orderByDescriptor","update","applyUpdate","action","model","_onDelete","createClass_default","Session","schema","db","state","withMutations","batchToken","getEmptyState","initialState","modelData","models","getModelClasses","sessionBoundModels","SessionBoundModel","Reflect","construct","setPrototypeOf","connect","getDataForModel","markAccessed","modelIds","data","accessedInstances","markFullTableScanned","fullTableScanned","markAccessedIndexes","indexes","attr","accessedIndexes","updateSpec","tx","_getTransaction","status","_markAccessedByQuery","idAttribute","accessedIds","Set","row","anyClauseFilteredById","some","clause","getNextState","[object Object]","forwardsManyToOneDescriptor","declaredToModelName","DeclaredToModel","getClass","toId","_fields","manyToManyDescriptor","declaredFromModelName","throughModelName","throughFields","reverse","DeclaredFromModel","ThroughModel","ThisModel","OtherModel","thisReferencingField","to","otherReferencingField","thisId","throughQs","referencedOtherIds","qs","otherModelInstance","has","entities","idsToAdd","existingQs","through","existingIds","clear","remove","idsToRemove","entitiesToDelete","size","entitiesToDeleteIds","unexistingIds","DefaultFieldInstaller","installForwardsDescriptor","field","createForwardsDescriptor","toModel","throughModel","installForwardsVirtualField","virtualFields","createForwardsVirtualField","installBackwardsDescriptor","backwardsFieldName","toModelName","reverseFieldErrorMessage","createBackwardsDescriptor","installBackwardsVirtualField","createBackwardsVirtualField","FieldInstallerTemplate","orm","references","run","installsForwardsDescriptor","installsForwardsVirtualField","installsBackwardsDescriptor","installsBackwardsVirtualField","_toModel","_throughModel","getThroughModelName","getBackwardsFieldName","Field","Attribute","_Field","_this","getDefault","inheritsLoose_default","attrDescriptor","RelationalField","_this2","_Field2","relatedName","as","toLowerCase","reverseFieldName","_DefaultFieldInstalle","AliasedForwardsDescriptorInstaller","ForeignKey","_RelationalField","_this3","_proto7","declaredFieldName","backwardsManyToOneDescriptor","ManyToMany","_RelationalField2","_proto8","getThroughFields","fieldAName","fieldBName","fieldA","fields","throughModelFieldReferencing","otherModel","find","someFieldName","OneToOne","_RelationalField3","_proto9","forwardsOneToOneDescriptor","backwardsOneToOneDescriptor","fk","many","oneToOne","getByIdQuery","modelInstance","Model","_initFields","propsObj","options","ids","_session","QuerySetClass","invalidateClassCache","isSetUp","_getTableOpts","backend","userProps","m2mRelations","declaredFieldNames","declaredVirtualFieldNames","valuePassed","_refreshMany2Many","upsert","idExists","_findDatabaseRows","equals","keysInA","entries","objectShallowEquals","propertyName","userMergeObj","mergeKey","mergedFields","updatedModel","relationsEqual","fieldsEqual","refreshFromState","ref","relations","normalizedNewIds","uniqueIds","fromField","toField","diffActions","idsToDelete","relatedQs","hasId","describe","DEFAULT_TABLE_OPTIONS","arrName","mapName","Table","accessId","branch","accessIds","accessIdList","accessList","getMaxId","getMeta","setMaxId","newMaxId","setMeta","nextId","pkIndex","attrIndexes","meta","reducer","indexAttrs","lastIndex","indexedIds","indexSet","newPayload","withoutIndexAttrs","filterAttr","reject","clauseReducesResultSetSize","entry","workingState","_currMax","userPassedId","newMax","newId","currMax","idSequencer","finalEntry","indexesToAppendTo","fkAttr","attrIndex","created","nextIndexes","indexMap","indexedAttrs","indexIdsToAdd","indexIdsToDelete","nextMap","prevAttrValues","valueMap","mergeObjInto","nextAttrValues","nextRow","prevValue","nextValue","rowId","valueIndex","attrIndexMap","tables","tableName","nextTableState","resultPayload","currTableState","nextDBState","newTableState","replaceTableState","createDatabase","schemaSpec","tableSpecs","tableSpec","argsAreEqual","nextArgs","accessedModelInstancesAreEqual","previous","ormState","instances","getDatabase","previousRows","rowsA","rowsB","rowsAreEqual","accessedIndexesAreEqual","column","fullTableScannedModelsAreEqual","fullTableScannedModels","argEqualityCheck","stateAndArgs","accessedModelInstances","createReducer","updater","ORM_DEFAULTS","defaultCreateDatabase","RESERVED_TABLE_OPTIONS","ORM","registry","implicitThroughModels","installedFields","register","registerManyToManyModelsFor","thisModelName","fieldInstance","selfReferencing","fromFieldName","toFieldName","Through","_Model","ForeignKeyClass","_ForeignKey","ThroughForeignKeyField","allModels","found","_setupModelPrototypes","generateSchemaSpec","spec","word","isReservedTableOption","mutableSession","_isFieldInstalled","_installField","_setFieldInstalled","FieldInstaller","installerClass","getDefaultState","__webpack_exports__","Schema","Backend","fields_Attribute","src_QuerySet","src_Model","ORM_ORM","src_Session","fields_ForeignKey","fields_ManyToMany","fields_OneToOne","fields_attr","redux_createSelector"],"mappings":"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","file":"redux-orm.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ReduxOrm\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ReduxOrm\"] = factory();\n\telse\n\t\troot[\"ReduxOrm\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 41);\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nmodule.exports = _inheritsLoose;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var baseAssignValue = require('./_baseAssignValue'),\n    baseForOwn = require('./_baseForOwn'),\n    baseIteratee = require('./_baseIteratee');\n\n/**\n * Creates an object with the same keys as `object` and values generated\n * by running each own enumerable string keyed property of `object` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, key, object).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Object} Returns the new mapped object.\n * @see _.mapKeys\n * @example\n *\n * var users = {\n *   'fred':    { 'user': 'fred',    'age': 40 },\n *   'pebbles': { 'user': 'pebbles', 'age': 1 }\n * };\n *\n * _.mapValues(users, function(o) { return o.age; });\n * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n *\n * // The `_.property` iteratee shorthand.\n * _.mapValues(users, 'age');\n * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n */\nfunction mapValues(object, iteratee) {\n  var result = {};\n  iteratee = baseIteratee(iteratee, 3);\n\n  baseForOwn(object, function(value, key, object) {\n    baseAssignValue(result, key, iteratee(value, key, object));\n  });\n  return result;\n}\n\nmodule.exports = mapValues;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    baseSortBy = require('./_baseSortBy'),\n    baseUnary = require('./_baseUnary'),\n    compareMultiple = require('./_compareMultiple'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `_.orderBy` without param guards.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n * @param {string[]} orders The sort orders of `iteratees`.\n * @returns {Array} Returns the new sorted array.\n */\nfunction baseOrderBy(collection, iteratees, orders) {\n  var index = -1;\n  iteratees = arrayMap(iteratees.length ? iteratees : [identity], baseUnary(baseIteratee));\n\n  var result = baseMap(collection, function(value, key, collection) {\n    var criteria = arrayMap(iteratees, function(iteratee) {\n      return iteratee(value);\n    });\n    return { 'criteria': criteria, 'index': ++index, 'value': value };\n  });\n\n  return baseSortBy(result, function(object, other) {\n    return compareMultiple(object, other, orders);\n  });\n}\n\nmodule.exports = baseOrderBy;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var arrayFilter = require('./_arrayFilter'),\n    baseFilter = require('./_baseFilter'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray'),\n    negate = require('./negate');\n\n/**\n * The opposite of `_.filter`; this method returns the elements of `collection`\n * that `predicate` does **not** return truthy for.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n * @see _.filter\n * @example\n *\n * var users = [\n *   { 'user': 'barney', 'age': 36, 'active': false },\n *   { 'user': 'fred',   'age': 40, 'active': true }\n * ];\n *\n * _.reject(users, function(o) { return !o.active; });\n * // => objects for ['fred']\n *\n * // The `_.matches` iteratee shorthand.\n * _.reject(users, { 'age': 40, 'active': true });\n * // => objects for ['barney']\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.reject(users, ['active', false]);\n * // => objects for ['fred']\n *\n * // The `_.property` iteratee shorthand.\n * _.reject(users, 'active');\n * // => objects for ['barney']\n */\nfunction reject(collection, predicate) {\n  var func = isArray(collection) ? arrayFilter : baseFilter;\n  return func(collection, negate(baseIteratee(predicate, 3)));\n}\n\nmodule.exports = reject;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var baseOrderBy = require('./_baseOrderBy'),\n    isArray = require('./isArray');\n\n/**\n * This method is like `_.sortBy` except that it allows specifying the sort\n * orders of the iteratees to sort by. If `orders` is unspecified, all values\n * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n * descending or \"asc\" for ascending sort order of corresponding values.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @param {string[]} [orders] The sort orders of `iteratees`.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 34 },\n *   { 'user': 'fred',   'age': 40 },\n *   { 'user': 'barney', 'age': 36 }\n * ];\n *\n * // Sort by `user` in ascending order and by `age` in descending order.\n * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n */\nfunction orderBy(collection, iteratees, orders, guard) {\n  if (collection == null) {\n    return [];\n  }\n  if (!isArray(iteratees)) {\n    iteratees = iteratees == null ? [] : [iteratees];\n  }\n  orders = guard ? undefined : orders;\n  if (!isArray(orders)) {\n    orders = orders == null ? [] : [orders];\n  }\n  return baseOrderBy(collection, iteratees, orders);\n}\n\nmodule.exports = orderBy;\n","var baseFlatten = require('./_baseFlatten'),\n    baseOrderBy = require('./_baseOrderBy'),\n    baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates an array of elements, sorted in ascending order by the results of\n * running each element in a collection thru each iteratee. This method\n * performs a stable sort, that is, it preserves the original sort order of\n * equal elements. The iteratees are invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {...(Function|Function[])} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 36 },\n *   { 'user': 'fred',   'age': 40 },\n *   { 'user': 'barney', 'age': 34 }\n * ];\n *\n * _.sortBy(users, [function(o) { return o.user; }]);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n *\n * _.sortBy(users, ['user', 'age']);\n * // => objects for [['barney', 34], ['barney', 36], ['fred', 40], ['fred', 48]]\n */\nvar sortBy = baseRest(function(collection, iteratees) {\n  if (collection == null) {\n    return [];\n  }\n  var length = iteratees.length;\n  if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n    iteratees = [];\n  } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n    iteratees = [iteratees[0]];\n  }\n  return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n});\n\nmodule.exports = sortBy;\n","'use strict';\n\nexports.__esModule = true;\nexports.defaultMemoize = defaultMemoize;\nexports.createSelectorCreator = createSelectorCreator;\nexports.createStructuredSelector = createStructuredSelector;\nfunction defaultEqualityCheck(a, b) {\n  return a === b;\n}\n\nfunction areArgumentsShallowlyEqual(equalityCheck, prev, next) {\n  if (prev === null || next === null || prev.length !== next.length) {\n    return false;\n  }\n\n  // Do this in a for loop (and not a `forEach` or an `every`) so we can determine equality as fast as possible.\n  var length = prev.length;\n  for (var i = 0; i < length; i++) {\n    if (!equalityCheck(prev[i], next[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction defaultMemoize(func) {\n  var equalityCheck = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultEqualityCheck;\n\n  var lastArgs = null;\n  var lastResult = null;\n  // we reference arguments instead of spreading them for performance reasons\n  return function () {\n    if (!areArgumentsShallowlyEqual(equalityCheck, lastArgs, arguments)) {\n      // apply arguments instead of spreading for performance.\n      lastResult = func.apply(null, arguments);\n    }\n\n    lastArgs = arguments;\n    return lastResult;\n  };\n}\n\nfunction getDependencies(funcs) {\n  var dependencies = Array.isArray(funcs[0]) ? funcs[0] : funcs;\n\n  if (!dependencies.every(function (dep) {\n    return typeof dep === 'function';\n  })) {\n    var dependencyTypes = dependencies.map(function (dep) {\n      return typeof dep;\n    }).join(', ');\n    throw new Error('Selector creators expect all input-selectors to be functions, ' + ('instead received the following types: [' + dependencyTypes + ']'));\n  }\n\n  return dependencies;\n}\n\nfunction createSelectorCreator(memoize) {\n  for (var _len = arguments.length, memoizeOptions = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    memoizeOptions[_key - 1] = arguments[_key];\n  }\n\n  return function () {\n    for (var _len2 = arguments.length, funcs = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      funcs[_key2] = arguments[_key2];\n    }\n\n    var recomputations = 0;\n    var resultFunc = funcs.pop();\n    var dependencies = getDependencies(funcs);\n\n    var memoizedResultFunc = memoize.apply(undefined, [function () {\n      recomputations++;\n      // apply arguments instead of spreading for performance.\n      return resultFunc.apply(null, arguments);\n    }].concat(memoizeOptions));\n\n    // If a selector is called with the exact same arguments we don't need to traverse our dependencies again.\n    var selector = defaultMemoize(function () {\n      var params = [];\n      var length = dependencies.length;\n\n      for (var i = 0; i < length; i++) {\n        // apply arguments instead of spreading and mutate a local list of params for performance.\n        params.push(dependencies[i].apply(null, arguments));\n      }\n\n      // apply arguments instead of spreading for performance.\n      return memoizedResultFunc.apply(null, params);\n    });\n\n    selector.resultFunc = resultFunc;\n    selector.recomputations = function () {\n      return recomputations;\n    };\n    selector.resetRecomputations = function () {\n      return recomputations = 0;\n    };\n    return selector;\n  };\n}\n\nvar createSelector = exports.createSelector = createSelectorCreator(defaultMemoize);\n\nfunction createStructuredSelector(selectors) {\n  var selectorCreator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : createSelector;\n\n  if (typeof selectors !== 'object') {\n    throw new Error('createStructuredSelector expects first argument to be an object ' + ('where each property is a selector, instead received a ' + typeof selectors));\n  }\n  var objectKeys = Object.keys(selectors);\n  return selectorCreator(objectKeys.map(function (key) {\n    return selectors[key];\n  }), function () {\n    for (var _len3 = arguments.length, values = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      values[_key3] = arguments[_key3];\n    }\n\n    return values.reduce(function (composition, value, index) {\n      composition[objectKeys[index]] = value;\n      return composition;\n    }, {});\n  });\n}","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that negates the result of the predicate `func`. The\n * `func` predicate is invoked with the `this` binding and arguments of the\n * created function.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {Function} predicate The predicate to negate.\n * @returns {Function} Returns the new negated function.\n * @example\n *\n * function isEven(n) {\n *   return n % 2 == 0;\n * }\n *\n * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n * // => [1, 3, 5]\n */\nfunction negate(predicate) {\n  if (typeof predicate != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  return function() {\n    var args = arguments;\n    switch (args.length) {\n      case 0: return !predicate.call(this);\n      case 1: return !predicate.call(this, args[0]);\n      case 2: return !predicate.call(this, args[0], args[1]);\n      case 3: return !predicate.call(this, args[0], args[1], args[2]);\n    }\n    return !predicate.apply(this, args);\n  };\n}\n\nmodule.exports = negate;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * The base implementation of `_.sortBy` which uses `comparer` to define the\n * sort order of `array` and replaces criteria objects with their corresponding\n * values.\n *\n * @private\n * @param {Array} array The array to sort.\n * @param {Function} comparer The function to define sort order.\n * @returns {Array} Returns `array`.\n */\nfunction baseSortBy(array, comparer) {\n  var length = array.length;\n\n  array.sort(comparer);\n  while (length--) {\n    array[length] = array[length].value;\n  }\n  return array;\n}\n\nmodule.exports = baseSortBy;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var compareAscending = require('./_compareAscending');\n\n/**\n * Used by `_.orderBy` to compare multiple properties of a value to another\n * and stable sort them.\n *\n * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n * of corresponding values.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {boolean[]|string[]} orders The order to sort by for each property.\n * @returns {number} Returns the sort order indicator for `object`.\n */\nfunction compareMultiple(object, other, orders) {\n  var index = -1,\n      objCriteria = object.criteria,\n      othCriteria = other.criteria,\n      length = objCriteria.length,\n      ordersLength = orders.length;\n\n  while (++index < length) {\n    var result = compareAscending(objCriteria[index], othCriteria[index]);\n    if (result) {\n      if (index >= ordersLength) {\n        return result;\n      }\n      var order = orders[index];\n      return result * (order == 'desc' ? -1 : 1);\n    }\n  }\n  // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n  // that causes it, under certain circumstances, to provide the same value for\n  // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n  // for more details.\n  //\n  // This also ensures a stable sort in V8 and other engines.\n  // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n  return object.index - other.index;\n}\n\nmodule.exports = compareMultiple;\n","var isSymbol = require('./isSymbol');\n\n/**\n * Compares values to sort them in ascending order.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {number} Returns the sort order indicator for `value`.\n */\nfunction compareAscending(value, other) {\n  if (value !== other) {\n    var valIsDefined = value !== undefined,\n        valIsNull = value === null,\n        valIsReflexive = value === value,\n        valIsSymbol = isSymbol(value);\n\n    var othIsDefined = other !== undefined,\n        othIsNull = other === null,\n        othIsReflexive = other === other,\n        othIsSymbol = isSymbol(other);\n\n    if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n        (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n        (valIsNull && othIsDefined && othIsReflexive) ||\n        (!valIsDefined && othIsReflexive) ||\n        !valIsReflexive) {\n      return 1;\n    }\n    if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n        (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n        (othIsNull && valIsDefined && valIsReflexive) ||\n        (!othIsDefined && valIsReflexive) ||\n        !othIsReflexive) {\n      return -1;\n    }\n  }\n  return 0;\n}\n\nmodule.exports = compareAscending;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","/**\n * Gets the first element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias first\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the first element of `array`.\n * @example\n *\n * _.head([1, 2, 3]);\n * // => 1\n *\n * _.head([]);\n * // => undefined\n */\nfunction head(array) {\n  return (array && array.length) ? array[0] : undefined;\n}\n\nmodule.exports = head;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","export default function _isPlaceholder(a) {\n       return a != null && typeof a === 'object' && a['@@functional/placeholder'] === true;\n}","import _isPlaceholder from './_isPlaceholder.js';\n\n/**\n * Optimized internal one-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curry1(fn) {\n  return function f1(a) {\n    if (arguments.length === 0 || _isPlaceholder(a)) {\n      return f1;\n    } else {\n      return fn.apply(this, arguments);\n    }\n  };\n}","export default function _arity(n, fn) {\n  /* eslint-disable no-unused-vars */\n  switch (n) {\n    case 0:\n      return function () {\n        return fn.apply(this, arguments);\n      };\n    case 1:\n      return function (a0) {\n        return fn.apply(this, arguments);\n      };\n    case 2:\n      return function (a0, a1) {\n        return fn.apply(this, arguments);\n      };\n    case 3:\n      return function (a0, a1, a2) {\n        return fn.apply(this, arguments);\n      };\n    case 4:\n      return function (a0, a1, a2, a3) {\n        return fn.apply(this, arguments);\n      };\n    case 5:\n      return function (a0, a1, a2, a3, a4) {\n        return fn.apply(this, arguments);\n      };\n    case 6:\n      return function (a0, a1, a2, a3, a4, a5) {\n        return fn.apply(this, arguments);\n      };\n    case 7:\n      return function (a0, a1, a2, a3, a4, a5, a6) {\n        return fn.apply(this, arguments);\n      };\n    case 8:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        return fn.apply(this, arguments);\n      };\n    case 9:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n        return fn.apply(this, arguments);\n      };\n    case 10:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9) {\n        return fn.apply(this, arguments);\n      };\n    default:\n      throw new Error('First argument to _arity must be a non-negative integer no greater than ten');\n  }\n}","import _arity from './internal/_arity.js';\nimport _curry1 from './internal/_curry1.js';\nimport _curry2 from './internal/_curry2.js';\nimport _curryN from './internal/_curryN.js';\n\n/**\n * Returns a curried equivalent of the provided function, with the specified\n * arity. The curried function has two unusual capabilities. First, its\n * arguments needn't be provided one at a time. If `g` is `R.curryN(3, f)`, the\n * following are equivalent:\n *\n *   - `g(1)(2)(3)`\n *   - `g(1)(2, 3)`\n *   - `g(1, 2)(3)`\n *   - `g(1, 2, 3)`\n *\n * Secondly, the special placeholder value [`R.__`](#__) may be used to specify\n * \"gaps\", allowing partial application of any combination of arguments,\n * regardless of their positions. If `g` is as above and `_` is [`R.__`](#__),\n * the following are equivalent:\n *\n *   - `g(1, 2, 3)`\n *   - `g(_, 2, 3)(1)`\n *   - `g(_, _, 3)(1)(2)`\n *   - `g(_, _, 3)(1, 2)`\n *   - `g(_, 2)(1)(3)`\n *   - `g(_, 2)(1, 3)`\n *   - `g(_, 2)(_, 3)(1)`\n *\n * @func\n * @memberOf R\n * @since v0.5.0\n * @category Function\n * @sig Number -> (* -> a) -> (* -> a)\n * @param {Number} length The arity for the returned function.\n * @param {Function} fn The function to curry.\n * @return {Function} A new, curried function.\n * @see R.curry\n * @example\n *\n *      const sumArgs = (...args) => R.sum(args);\n *\n *      const curriedAddFourNumbers = R.curryN(4, sumArgs);\n *      const f = curriedAddFourNumbers(1, 2);\n *      const g = f(3);\n *      g(4); //=> 10\n */\nvar curryN = /*#__PURE__*/_curry2(function curryN(length, fn) {\n  if (length === 1) {\n    return _curry1(fn);\n  }\n  return _arity(length, _curryN(length, [], fn));\n});\nexport default curryN;","import _curry1 from './_curry1.js';\nimport _isPlaceholder from './_isPlaceholder.js';\n\n/**\n * Optimized internal two-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curry2(fn) {\n  return function f2(a, b) {\n    switch (arguments.length) {\n      case 0:\n        return f2;\n      case 1:\n        return _isPlaceholder(a) ? f2 : _curry1(function (_b) {\n          return fn(a, _b);\n        });\n      default:\n        return _isPlaceholder(a) && _isPlaceholder(b) ? f2 : _isPlaceholder(a) ? _curry1(function (_a) {\n          return fn(_a, b);\n        }) : _isPlaceholder(b) ? _curry1(function (_b) {\n          return fn(a, _b);\n        }) : fn(a, b);\n    }\n  };\n}","import _arity from './_arity.js';\nimport _isPlaceholder from './_isPlaceholder.js';\n\n/**\n * Internal curryN function.\n *\n * @private\n * @category Function\n * @param {Number} length The arity of the curried function.\n * @param {Array} received An array of arguments received thus far.\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curryN(length, received, fn) {\n  return function () {\n    var combined = [];\n    var argsIdx = 0;\n    var left = length;\n    var combinedIdx = 0;\n    while (combinedIdx < received.length || argsIdx < arguments.length) {\n      var result;\n      if (combinedIdx < received.length && (!_isPlaceholder(received[combinedIdx]) || argsIdx >= arguments.length)) {\n        result = received[combinedIdx];\n      } else {\n        result = arguments[argsIdx];\n        argsIdx += 1;\n      }\n      combined[combinedIdx] = result;\n      if (!_isPlaceholder(result)) {\n        left -= 1;\n      }\n      combinedIdx += 1;\n    }\n    return left <= 0 ? fn.apply(this, combined) : _arity(left, _curryN(length, combined, fn));\n  };\n}","import _curry1 from './internal/_curry1.js';\nimport curryN from './curryN.js';\n\n/**\n * Returns a curried equivalent of the provided function. The curried function\n * has two unusual capabilities. First, its arguments needn't be provided one\n * at a time. If `f` is a ternary function and `g` is `R.curry(f)`, the\n * following are equivalent:\n *\n *   - `g(1)(2)(3)`\n *   - `g(1)(2, 3)`\n *   - `g(1, 2)(3)`\n *   - `g(1, 2, 3)`\n *\n * Secondly, the special placeholder value [`R.__`](#__) may be used to specify\n * \"gaps\", allowing partial application of any combination of arguments,\n * regardless of their positions. If `g` is as above and `_` is [`R.__`](#__),\n * the following are equivalent:\n *\n *   - `g(1, 2, 3)`\n *   - `g(_, 2, 3)(1)`\n *   - `g(_, _, 3)(1)(2)`\n *   - `g(_, _, 3)(1, 2)`\n *   - `g(_, 2)(1)(3)`\n *   - `g(_, 2)(1, 3)`\n *   - `g(_, 2)(_, 3)(1)`\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Function\n * @sig (* -> a) -> (* -> a)\n * @param {Function} fn The function to curry.\n * @return {Function} A new, curried function.\n * @see R.curryN, R.partial\n * @example\n *\n *      const addFourNumbers = (a, b, c, d) => a + b + c + d;\n *\n *      const curriedAddFourNumbers = R.curry(addFourNumbers);\n *      const f = curriedAddFourNumbers(1, 2);\n *      const g = f(3);\n *      g(4); //=> 10\n */\nvar curry = /*#__PURE__*/_curry1(function curry(fn) {\n  return curryN(fn.length, fn);\n});\nexport default curry;","/**\n * A special placeholder value used to specify \"gaps\" within curried functions,\n * allowing partial application of any combination of arguments, regardless of\n * their positions.\n *\n * If `g` is a curried ternary function and `_` is `R.__`, the following are\n * equivalent:\n *\n *   - `g(1, 2, 3)`\n *   - `g(_, 2, 3)(1)`\n *   - `g(_, _, 3)(1)(2)`\n *   - `g(_, _, 3)(1, 2)`\n *   - `g(_, 2, _)(1, 3)`\n *   - `g(_, 2)(1)(3)`\n *   - `g(_, 2)(1, 3)`\n *   - `g(_, 2)(_, 3)(1)`\n *\n * @name __\n * @constant\n * @memberOf R\n * @since v0.6.0\n * @category Function\n * @example\n *\n *      const greet = R.replace('{name}', R.__, 'Hello, {name}!');\n *      greet('Alice'); //=> 'Hello, Alice!'\n */\nexport default { '@@functional/placeholder': true };","import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nimport { curry, __ as placeholder } from 'ramda';\n\nfunction forOwn(obj, fn) {\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      fn(obj[key], key);\n    }\n  }\n}\n\nfunction isArrayLike(value) {\n  return value && _typeof(value) === 'object' && typeof value.length === 'number' && value.length >= 0 && value.length % 1 === 0;\n}\n\nvar OWNER_ID_TAG = '@@_______immutableOpsOwnerID';\n\nfunction fastArrayCopy(arr) {\n  var copied = new Array(arr.length);\n\n  for (var i = 0; i < arr.length; i++) {\n    copied[i] = arr[i];\n  }\n\n  return copied;\n}\n\nexport function canMutate(obj, ownerID) {\n  if (!ownerID) return false;\n  return obj[OWNER_ID_TAG] === ownerID;\n}\nvar newOwnerID = typeof Symbol === 'function' ? function () {\n  return Symbol('ownerID');\n} : function () {\n  return {};\n};\nexport var getBatchToken = newOwnerID;\n\nfunction addOwnerID(obj, ownerID) {\n  Object.defineProperty(obj, OWNER_ID_TAG, {\n    value: ownerID,\n    configurable: true,\n    enumerable: false\n  });\n  return obj;\n}\n\nfunction prepareNewObject(instance, ownerID) {\n  if (ownerID) {\n    addOwnerID(instance, ownerID);\n  }\n\n  return instance;\n}\n\nfunction forceArray(arg) {\n  if (!(arg instanceof Array)) {\n    return [arg];\n  }\n\n  return arg;\n}\n\nvar PATH_SEPARATOR = '.';\n\nfunction normalizePath(pathArg) {\n  if (typeof pathArg === 'string') {\n    if (pathArg.indexOf(PATH_SEPARATOR) === -1) {\n      return [pathArg];\n    }\n\n    return pathArg.split(PATH_SEPARATOR);\n  }\n\n  return pathArg;\n}\n\nfunction mutableSet(key, value, obj) {\n  obj[key] = value;\n  return obj;\n}\n\nfunction mutableSetIn(_pathArg, value, obj) {\n  var originalPathArg = normalizePath(_pathArg);\n  var pathLen = originalPathArg.length;\n  var done = false;\n  var idx = 0;\n  var acc = obj;\n  var curr = originalPathArg[idx];\n\n  while (!done) {\n    if (idx === pathLen - 1) {\n      acc[curr] = value;\n      done = true;\n    } else {\n      var currType = _typeof(acc[curr]);\n\n      if (currType === 'undefined') {\n        var newObj = {};\n        prepareNewObject(newObj, null);\n        acc[curr] = newObj;\n      } else if (currType !== 'object') {\n        var pathRepr = \"\".concat(originalPathArg[idx - 1], \".\").concat(curr);\n        throw new Error(\"A non-object value was encountered when traversing setIn path at \".concat(pathRepr, \".\"));\n      }\n\n      acc = acc[curr];\n      idx++;\n      curr = originalPathArg[idx];\n    }\n  }\n\n  return obj;\n}\n\nfunction valueInPath(_pathArg, obj) {\n  var pathArg = normalizePath(_pathArg);\n  var acc = obj;\n\n  for (var i = 0; i < pathArg.length; i++) {\n    var curr = pathArg[i];\n    var currRef = acc[curr];\n\n    if (i === pathArg.length - 1) {\n      return currRef;\n    }\n\n    if (_typeof(currRef) === 'object') {\n      acc = currRef;\n    } else {\n      return undefined;\n    }\n  }\n\n  return undefined;\n}\n\nfunction immutableSetIn(ownerID, _pathArg, value, obj) {\n  var pathArg = normalizePath(_pathArg);\n  var currentValue = valueInPath(pathArg, obj);\n  if (value === currentValue) return obj;\n  var pathLen = pathArg.length;\n  var acc;\n\n  if (canMutate(obj, ownerID)) {\n    acc = obj;\n  } else {\n    acc = Object.assign(prepareNewObject({}, ownerID), obj);\n  }\n\n  var rootObj = acc;\n  pathArg.forEach(function (curr, idx) {\n    if (idx === pathLen - 1) {\n      acc[curr] = value;\n      return;\n    }\n\n    var currRef = acc[curr];\n\n    var currType = _typeof(currRef);\n\n    if (currType === 'object') {\n      if (canMutate(currRef, ownerID)) {\n        acc = currRef;\n      } else {\n        var newObj = prepareNewObject({}, ownerID);\n        acc[curr] = Object.assign(newObj, currRef);\n        acc = newObj;\n      }\n\n      return;\n    }\n\n    if (currType === 'undefined') {\n      var _newObj = prepareNewObject({}, ownerID);\n\n      acc[curr] = _newObj;\n      acc = _newObj;\n      return;\n    }\n\n    var pathRepr = \"\".concat(pathArg[idx - 1], \".\").concat(curr);\n    throw new Error(\"A non-object value was encountered when traversing setIn path at \".concat(pathRepr, \".\"));\n  });\n  return rootObj;\n}\n\nfunction mutableMerge(isDeep, _mergeObjs, baseObj) {\n  var mergeObjs = forceArray(_mergeObjs);\n\n  if (isDeep) {\n    mergeObjs.forEach(function (mergeObj) {\n      forOwn(mergeObj, function (value, key) {\n        if (isDeep && baseObj.hasOwnProperty(key)) {\n          var assignValue;\n\n          if (_typeof(value) === 'object') {\n            assignValue = mutableMerge(isDeep, [value], baseObj[key]);\n          } else {\n            assignValue = value;\n          }\n\n          baseObj[key] = assignValue;\n        } else {\n          baseObj[key] = value;\n        }\n      });\n    });\n  } else {\n    Object.assign.apply(Object, [baseObj].concat(_toConsumableArray(mergeObjs)));\n  }\n\n  return baseObj;\n}\n\nvar mutableShallowMerge = mutableMerge.bind(null, false);\nvar mutableDeepMerge = mutableMerge.bind(null, true);\n\nfunction mutableOmit(_keys, obj) {\n  var keys = forceArray(_keys);\n  keys.forEach(function (key) {\n    delete obj[key];\n  });\n  return obj;\n}\n\nfunction shouldMergeKey(obj, other, key) {\n  return obj[key] !== other[key];\n}\n\nfunction immutableMerge(isDeep, ownerID, _mergeObjs, obj) {\n  if (canMutate(obj, ownerID)) return mutableMerge(isDeep, _mergeObjs, obj);\n  var mergeObjs = forceArray(_mergeObjs);\n  var hasChanges = false;\n  var nextObject = obj;\n\n  var willChange = function willChange() {\n    if (!hasChanges) {\n      hasChanges = true;\n      nextObject = Object.assign({}, obj);\n      prepareNewObject(nextObject, ownerID);\n    }\n  };\n\n  mergeObjs.forEach(function (mergeObj) {\n    forOwn(mergeObj, function (mergeValue, key) {\n      if (isDeep && obj.hasOwnProperty(key)) {\n        var currentValue = nextObject[key];\n\n        if (_typeof(mergeValue) === 'object' && !(mergeValue instanceof Array)) {\n          if (shouldMergeKey(nextObject, mergeObj, key)) {\n            var recursiveMergeResult = immutableMerge(isDeep, ownerID, mergeValue, currentValue);\n\n            if (recursiveMergeResult !== currentValue) {\n              willChange();\n              nextObject[key] = recursiveMergeResult;\n            }\n          }\n\n          return true; // continue forOwn\n        }\n      }\n\n      if (shouldMergeKey(nextObject, mergeObj, key)) {\n        willChange();\n        nextObject[key] = mergeValue;\n      }\n\n      return undefined;\n    });\n  });\n  return nextObject;\n}\n\nvar immutableDeepMerge = immutableMerge.bind(null, true);\nvar immutableShallowMerge = immutableMerge.bind(null, false);\n\nfunction immutableArrSet(ownerID, index, value, arr) {\n  if (canMutate(arr, ownerID)) return mutableSet(index, value, arr);\n  if (arr[index] === value) return arr;\n  var newArr = fastArrayCopy(arr);\n  newArr[index] = value;\n  prepareNewObject(newArr, ownerID);\n  return newArr;\n}\n\nfunction immutableSet(ownerID, key, value, obj) {\n  if (isArrayLike(obj)) return immutableArrSet(ownerID, key, value, obj);\n  if (canMutate(obj, ownerID)) return mutableSet(key, value, obj);\n  if (obj[key] === value) return obj;\n  var newObj = Object.assign({}, obj);\n  prepareNewObject(newObj, ownerID);\n  newObj[key] = value;\n  return newObj;\n}\n\nfunction immutableOmit(ownerID, _keys, obj) {\n  if (canMutate(obj, ownerID)) return mutableOmit(_keys, obj);\n  var keys = forceArray(_keys);\n  var keysInObj = keys.filter(function (key) {\n    return obj.hasOwnProperty(key);\n  }); // None of the keys were in the object, so we can return `obj`.\n\n  if (keysInObj.length === 0) return obj;\n  var newObj = Object.assign({}, obj);\n  keysInObj.forEach(function (key) {\n    delete newObj[key];\n  });\n  prepareNewObject(newObj, ownerID);\n  return newObj;\n}\n\nfunction mutableArrPush(_vals, arr) {\n  var vals = forceArray(_vals);\n  arr.push.apply(arr, _toConsumableArray(vals));\n  return arr;\n}\n\nfunction mutableArrFilter(func, arr) {\n  var currIndex = 0;\n  var originalIndex = 0;\n\n  while (currIndex < arr.length) {\n    var item = arr[currIndex];\n\n    if (!func(item, originalIndex)) {\n      arr.splice(currIndex, 1);\n    } else {\n      currIndex++;\n    }\n\n    originalIndex++;\n  }\n\n  return arr;\n}\n\nfunction mutableArrSplice(index, deleteCount, _vals, arr) {\n  var vals = forceArray(_vals);\n  arr.splice.apply(arr, [index, deleteCount].concat(_toConsumableArray(vals)));\n  return arr;\n}\n\nfunction mutableArrInsert(index, _vals, arr) {\n  return mutableArrSplice(index, 0, _vals, arr);\n}\n\nfunction immutableArrSplice(ownerID, index, deleteCount, _vals, arr) {\n  if (canMutate(arr, ownerID)) return mutableArrSplice(index, deleteCount, _vals, arr);\n  var vals = forceArray(_vals);\n  var newArr = arr.slice();\n  prepareNewObject(newArr, ownerID);\n  newArr.splice.apply(newArr, [index, deleteCount].concat(_toConsumableArray(vals)));\n  return newArr;\n}\n\nfunction immutableArrInsert(ownerID, index, _vals, arr) {\n  if (canMutate(arr, ownerID)) return mutableArrInsert(index, _vals, arr);\n  return immutableArrSplice(ownerID, index, 0, _vals, arr);\n}\n\nfunction immutableArrPush(ownerID, vals, arr) {\n  return immutableArrInsert(ownerID, arr.length, vals, arr);\n}\n\nfunction immutableArrFilter(ownerID, func, arr) {\n  if (canMutate(arr, ownerID)) return mutableArrFilter(func, arr);\n  var newArr = arr.filter(func);\n  if (newArr.length === arr.length) return arr;\n  prepareNewObject(newArr, ownerID);\n  return newArr;\n}\n\nvar immutableOperations = {\n  // object operations\n  merge: immutableShallowMerge,\n  deepMerge: immutableDeepMerge,\n  omit: immutableOmit,\n  setIn: immutableSetIn,\n  // array operations\n  insert: immutableArrInsert,\n  push: immutableArrPush,\n  filter: immutableArrFilter,\n  splice: immutableArrSplice,\n  // both\n  set: immutableSet\n};\nvar mutableOperations = {\n  // object operations\n  merge: mutableShallowMerge,\n  deepMerge: mutableDeepMerge,\n  omit: mutableOmit,\n  setIn: mutableSetIn,\n  // array operations\n  insert: mutableArrInsert,\n  push: mutableArrPush,\n  filter: mutableArrFilter,\n  splice: mutableArrSplice,\n  // both\n  set: mutableSet\n};\nexport function getImmutableOps() {\n  var immutableOps = Object.assign({}, immutableOperations);\n  forOwn(immutableOps, function (value, key) {\n    immutableOps[key] = curry(value.bind(null, null));\n  });\n  var mutableOps = Object.assign({}, mutableOperations);\n  forOwn(mutableOps, function (value, key) {\n    mutableOps[key] = curry(value);\n  });\n  var batchOps = Object.assign({}, immutableOperations);\n  forOwn(batchOps, function (value, key) {\n    batchOps[key] = curry(value);\n  });\n\n  function batched(_token, _fn) {\n    var token;\n    var fn;\n\n    if (typeof _token === 'function') {\n      fn = _token;\n      token = getBatchToken();\n    } else {\n      token = _token;\n      fn = _fn;\n    }\n\n    var immutableOpsBoundToToken = Object.assign({}, immutableOperations);\n    forOwn(immutableOpsBoundToToken, function (value, key) {\n      immutableOpsBoundToToken[key] = curry(value.bind(null, token));\n    });\n    return fn(immutableOpsBoundToToken);\n  }\n\n  return Object.assign(immutableOps, {\n    mutable: mutableOps,\n    batch: batchOps,\n    batched: batched,\n    __: placeholder,\n    getBatchToken: getBatchToken\n  });\n}\nexport var ops = getImmutableOps();\nexport default ops;","export const UPDATE = 'REDUX_ORM_UPDATE';\nexport const DELETE = 'REDUX_ORM_DELETE';\nexport const CREATE = 'REDUX_ORM_CREATE';\n\nexport const FILTER = 'REDUX_ORM_FILTER';\nexport const EXCLUDE = 'REDUX_ORM_EXCLUDE';\nexport const ORDER_BY = 'REDUX_ORM_ORDER_BY';\n\nexport const SUCCESS = 'SUCCESS';\nexport const FAILURE = 'FAILURE';\n","import ops from 'immutable-ops';\nimport { FILTER, EXCLUDE } from './constants';\n\n/**\n * @module utils\n */\n\nfunction warnDeprecated(msg) {\n    const logger = typeof console.warn === 'function'\n        ? console.warn.bind(console)\n        : console.log.bind(console);\n    return logger(msg);\n}\n\nfunction capitalize(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\n/**\n * Returns the branch name for a many-to-many relation.\n * The name is the combination of the model name and the field name the relation\n * was declared. The field name's first letter is capitalized.\n *\n * Example: model `Author` has a many-to-many relation to the model `Book`, defined\n * in the `Author` field `books`. The many-to-many branch name will be `AuthorBooks`.\n *\n * @param  {string} declarationModelName - the name of the model the many-to-many relation was declared on\n * @param  {string} fieldName            - the field name where the many-to-many relation was declared on\n * @return {string} The branch name for the many-to-many relation.\n */\nfunction m2mName(declarationModelName, fieldName) {\n    return declarationModelName + capitalize(fieldName);\n}\n\n/**\n * Returns the fieldname that saves a foreign key to the\n * model id where the many-to-many relation was declared.\n *\n * Example: `Author` => `fromAuthorId`\n *\n * @private\n * @param  {string} declarationModelName - the name of the model where the relation was declared\n * @return {string} the field name in the through model for `declarationModelName`'s foreign key.\n */\nfunction m2mFromFieldName(declarationModelName) {\n    return `from${declarationModelName}Id`;\n}\n\n/**\n * Returns the fieldname that saves a foreign key in a many-to-many through model to the\n * model where the many-to-many relation was declared.\n *\n * Example: `Book` => `toBookId`\n *\n * @param  {string} otherModelName - the name of the model that was the target of the many-to-many\n *                                   declaration.\n * @return {string} the field name in the through model for `otherModelName`'s foreign key..\n */\nfunction m2mToFieldName(otherModelName) {\n    return `to${otherModelName}Id`;\n}\n\nfunction reverseFieldName(modelName) {\n    return modelName.toLowerCase() + 'Set'; // eslint-disable-line prefer-template\n}\n\nfunction querySetDelegatorFactory(methodName) {\n    return function querySetDelegator(...args) {\n        return this.getQuerySet()[methodName](...args);\n    };\n}\n\nfunction querySetGetterDelegatorFactory(getterName) {\n    return function querySetGetterDelegator() {\n        const qs = this.getQuerySet();\n        return qs[getterName];\n    };\n}\n\nfunction forEachSuperClass(subClass, func) {\n    let currClass = subClass;\n    while (currClass !== Function.prototype) {\n        func(currClass);\n        currClass = Object.getPrototypeOf(currClass);\n    }\n}\n\nfunction attachQuerySetMethods(modelClass, querySetClass) {\n    const leftToDefine = querySetClass.sharedMethods.slice();\n\n    // There is no way to get a property descriptor for the whole prototype chain;\n    // only from an objects own properties. Therefore we traverse the whole prototype\n    // chain for querySet.\n    forEachSuperClass(querySetClass, (cls) => {\n        for (let i = 0; i < leftToDefine.length; i++) {\n            let defined = false;\n            const methodName = leftToDefine[i];\n            const descriptor = Object.getOwnPropertyDescriptor(cls.prototype, methodName);\n            if (typeof descriptor !== 'undefined') {\n                if (typeof descriptor.get !== 'undefined') {\n                    descriptor.get = querySetGetterDelegatorFactory(methodName);\n                    Object.defineProperty(modelClass, methodName, descriptor);\n                    defined = true;\n                } else if (typeof descriptor.value === 'function') {\n                    modelClass[methodName] = querySetDelegatorFactory(methodName);\n                    defined = true;\n                }\n            }\n            if (defined) {\n                leftToDefine.splice(i--, 1);\n            }\n        }\n    });\n}\n\n/**\n * Normalizes `entity` to an id, where `entity` can be an id\n * or a Model instance.\n *\n * @param  {*} entity - either a Model instance or an id value\n * @return {*} the id value of `entity`\n */\nfunction normalizeEntity(entity) {\n    if (entity !== null &&\n            typeof entity !== 'undefined' &&\n            typeof entity.getId === 'function') {\n        return entity.getId();\n    }\n    return entity;\n}\n\nfunction reverseFieldErrorMessage(modelName, fieldName, toModelName, backwardsFieldName) {\n    return [\n        `Reverse field ${backwardsFieldName} already defined`,\n        ` on model ${toModelName}. To fix, set a custom related`,\n        ` name on ${modelName}.${fieldName}.`,\n    ].join('');\n}\n\nfunction objectShallowEquals(a, b) {\n    let keysInA = 0;\n\n    // eslint-disable-next-line consistent-return\n    Object.entries(Object(a)).forEach(([key, value]) => {\n        if (!b.hasOwnProperty(key) || b[key] !== value) {\n            return false;\n        }\n        keysInA++;\n    });\n\n    return keysInA === Object.keys(b).length;\n}\n\nfunction arrayDiffActions(sourceArr, targetArr) {\n    const itemsInBoth = sourceArr.filter(item => targetArr.includes(item));\n    const deleteItems = sourceArr.filter(item => !itemsInBoth.includes(item));\n    const addItems = targetArr.filter(item => !itemsInBoth.includes(item));\n\n    if (deleteItems.length || addItems.length) {\n        return {\n            delete: deleteItems,\n            add: addItems,\n        };\n    }\n    return null;\n}\n\nconst { getBatchToken } = ops;\n\nfunction clauseFiltersByAttribute({ type, payload }, attribute) {\n    if (type !== FILTER) return false;\n\n    if (typeof payload !== 'object') {\n        /**\n         * payload could also be a function in which case\n         * we would have no way of knowing what it does,\n         * so we default to false for non-objects\n         */\n        return false;\n    }\n\n    if (!payload.hasOwnProperty(attribute)) return false;\n    const attributeValue = payload[attribute];\n    if (attributeValue === null) return false;\n    if (attributeValue === undefined) return false;\n\n    return true;\n}\n\nfunction clauseReducesResultSetSize({ type }) {\n    return [FILTER, EXCLUDE].includes(type);\n}\n\nexport {\n    attachQuerySetMethods,\n    m2mName,\n    m2mFromFieldName,\n    m2mToFieldName,\n    reverseFieldName,\n    normalizeEntity,\n    reverseFieldErrorMessage,\n    objectShallowEquals,\n    ops,\n    arrayDiffActions,\n    getBatchToken,\n    clauseFiltersByAttribute,\n    clauseReducesResultSetSize,\n    warnDeprecated,\n};\n","import mapValues from 'lodash/mapValues';\nimport {\n    normalizeEntity,\n    warnDeprecated,\n} from './utils';\n\nimport {\n    UPDATE,\n    DELETE,\n    FILTER,\n    EXCLUDE,\n    ORDER_BY,\n} from './constants';\n\n/**\n * This class is used to build and make queries to the database\n * and operating the resulting set (such as updating attributes\n * or deleting the records).\n *\n * The queries are built lazily. For example:\n *\n * ```javascript\n * const qs = Book.all()\n *     .filter(book => book.releaseYear > 1999)\n *     .orderBy('name');\n * ```\n *\n * Doesn't execute a query. The query is executed only when\n * you need information from the query result, such as {@link QuerySet#count},\n * {@link QuerySet#toRefArray}. After the query is executed, the resulting\n * set is cached in the QuerySet instance.\n *\n * QuerySet instances also return copies, so chaining filters doesn't\n * mutate the previous instances.\n */\nconst QuerySet = class QuerySet {\n    /**\n     * Creates a QuerySet. The constructor is mainly for internal use;\n     * You should access QuerySet instances from {@link Model}.\n     *\n     * @param  {Model} modelClass - the model class of objects in this QuerySet.\n     * @param  {any[]} clauses - query clauses needed to evaluate the set.\n     * @param {Object} [opts] - additional options\n     */\n    constructor(modelClass, clauses, opts) {\n        Object.assign(this, {\n            modelClass,\n            clauses: clauses || [],\n        });\n\n        this._opts = opts;\n    }\n\n    static addSharedMethod(methodName) {\n        this.sharedMethods = this.sharedMethods.concat(methodName);\n    }\n\n    _new(clauses, userOpts) {\n        const opts = Object.assign({}, this._opts, userOpts);\n        return new this.constructor(this.modelClass, clauses, opts);\n    }\n\n    toString() {\n        this._evaluate();\n        const contents = this.rows.map(({ id }) => this.modelClass.withId(id).toString()\n        ).join('\\n    - ');\n        return `QuerySet contents:\\n    - ${contents}`;\n    }\n\n    /**\n     * Returns an array of the plain objects represented by the QuerySet.\n     * The plain objects are direct references to the store.\n     *\n     * @return {Object[]} references to the plain JS objects represented by\n     *                    the QuerySet\n     */\n    toRefArray() {\n        return this._evaluate();\n    }\n\n    /**\n     * Returns an array of {@link Model} instances represented by the QuerySet.\n     * @return {Model[]} model instances represented by the QuerySet\n     */\n    toModelArray() {\n        const { modelClass: ModelClass } = this;\n        return this._evaluate().map(\n            props => new ModelClass(props)\n        );\n    }\n\n    /**\n     * Returns the number of {@link Model} instances represented by the QuerySet.\n     *\n     * @return {number} length of the QuerySet\n     */\n    count() {\n        this._evaluate();\n        return this.rows.length;\n    }\n\n    /**\n     * Checks if the {@link QuerySet} instance has any records matching the query\n     * in the database.\n     *\n     * @return {Boolean} `true` if the {@link QuerySet} instance contains entities, else `false`.\n     */\n    exists() {\n        return Boolean(this.count());\n    }\n\n    /**\n     * Returns the {@link Model} instance at index `index` in the {@link QuerySet} instance if\n     * `withRefs` flag is set to `false`, or a reference to the plain JavaScript\n     * object in the model state if `true`.\n     *\n     * @param  {number} index - index of the model instance to get\n     * @return {Model|undefined} a {@link Model} instance at index\n     *                           `index` in the {@link QuerySet} instance,\n     *                           or undefined if the index is out of bounds.\n     */\n    at(index) {\n        const { modelClass: ModelClass } = this;\n\n        const rows = this._evaluate();\n        if (index >= 0 && index < rows.length) {\n            return new ModelClass(rows[index]);\n        }\n\n        return undefined;\n    }\n\n    /**\n     * Returns the {@link Model} instance at index 0 in the {@link QuerySet} instance.\n     * @return {Model}\n     */\n    first() {\n        return this.at(0);\n    }\n\n    /**\n     * Returns the {@link Model} instance at index `QuerySet.count() - 1`\n     * @return {Model}\n     */\n    last() {\n        const rows = this._evaluate();\n        return this.at(rows.length - 1);\n    }\n\n    /**\n     * Returns a new {@link QuerySet} instance with the same entities.\n     * @return {QuerySet} a new QuerySet with the same entities.\n     */\n    all() {\n        return this._new(this.clauses);\n    }\n\n    /**\n     * Returns a new {@link QuerySet} instance with entities that match properties in `lookupObj`.\n     *\n     * @param  {Object} lookupObj - the properties to match objects with. Can also be a function.\n     * @return {QuerySet} a new {@link QuerySet} instance with objects that passed the filter.\n     */\n    filter(lookupObj) {\n        /**\n         * allow foreign keys to be specified as model instances,\n         * transform model instances to their primary keys\n         */\n        const normalizedLookupObj = typeof lookupObj === 'object'\n            ? mapValues(lookupObj, normalizeEntity)\n            : lookupObj;\n\n        const filterDescriptor = {\n            type: FILTER,\n            payload: normalizedLookupObj,\n        };\n        /**\n         * create a new QuerySet\n         * including only rows matching the lookupObj\n         */\n        return this._new(\n            this.clauses.concat(filterDescriptor)\n        );\n    }\n\n    /**\n     * Returns a new {@link QuerySet} instance with entities that do not match\n     * properties in `lookupObj`.\n     *\n     * @param  {Object} lookupObj - the properties to unmatch objects with. Can also be a function.\n     * @return {QuerySet} a new {@link QuerySet} instance with objects that did not pass the filter.\n     */\n    exclude(lookupObj) {\n        /**\n         * allow foreign keys to be specified as model instances,\n         * transform model instances to their primary keys\n         */\n        const normalizedLookupObj = typeof lookupObj === 'object'\n            ? mapValues(lookupObj, normalizeEntity)\n            : lookupObj;\n        const excludeDescriptor = {\n            type: EXCLUDE,\n            payload: normalizedLookupObj,\n        };\n\n        /**\n         * create a new QuerySet\n         * excluding all rows matching the lookupObj\n         */\n        return this._new(\n            this.clauses.concat(excludeDescriptor)\n        );\n    }\n\n    /**\n     * Performs the actual database query.\n     * @private\n     * @return {Array} rows corresponding to the QuerySet's clauses\n     */\n    _evaluate() {\n        if (typeof this.modelClass.session === 'undefined') {\n            throw new Error([\n                `Tried to query the ${this.modelClass.modelName} model's table without a session. `,\n                'Create a session using `session = orm.session()` and use ',\n                `\\`session[\"${this.modelClass.modelName}\"]\\` for querying instead.`,\n            ].join(''));\n        }\n        if (!this._evaluated) {\n            const {\n                session,\n                modelName: table,\n            } = this.modelClass;\n            const querySpec = {\n                table,\n                clauses: this.clauses,\n            };\n            this.rows = session.query(querySpec).rows;\n            this._evaluated = true;\n        }\n        return this.rows;\n    }\n\n    /**\n     * Returns a new {@link QuerySet} instance with entities ordered by `iteratees` in ascending\n     * order, unless otherwise specified. Delegates to `lodash.orderBy`.\n     *\n     * @param  {string[]|Function[]} iteratees - an array where each item can be a string or a\n     *                                           function. If a string is supplied, it should\n     *                                           correspond to property on the entity that will\n     *                                           determine the order. If a function is supplied,\n     *                                           it should return the value to order by.\n     * @param {Boolean[]} [orders] - the sort orders of `iteratees`. If unspecified, all iteratees\n     *                               will be sorted in ascending order. `true` and `'asc'`\n     *                               correspond to ascending order, and `false` and `'desc`\n     *                               to descending order.\n     * @return {QuerySet} a new {@link QuerySet} with objects ordered by `iteratees`.\n     */\n    orderBy(iteratees, orders) {\n        const orderByDescriptor = {\n            type: ORDER_BY,\n            payload: [iteratees, orders],\n        };\n\n        /**\n         * create a new QuerySet\n         * sorting all rows according to the passed arguments\n         */\n        return this._new(\n            this.clauses.concat(orderByDescriptor)\n        );\n    }\n\n    /**\n     * Records an update specified with `mergeObj` to all the objects\n     * in the {@link QuerySet} instance.\n     *\n     * @param  {Object} mergeObj - an object to merge with all the objects in this\n     *                             queryset.\n     * @return {undefined}\n     */\n    update(mergeObj) {\n        const {\n            session,\n            modelName: table,\n        } = this.modelClass;\n\n        session.applyUpdate({\n            action: UPDATE,\n            query: {\n                table,\n                clauses: this.clauses,\n            },\n            payload: mergeObj,\n        });\n\n        this._evaluated = false;\n    }\n\n    /**\n     * Records a deletion of all the objects in this {@link QuerySet} instance.\n     * @return {undefined}\n     */\n    delete() {\n        const {\n            session,\n            modelName: table,\n        } = this.modelClass;\n\n        this.toModelArray().forEach(\n            model => model._onDelete() // eslint-disable-line no-underscore-dangle\n        );\n\n        session.applyUpdate({\n            action: DELETE,\n            query: {\n                table,\n                clauses: this.clauses,\n            },\n        });\n\n        this._evaluated = false;\n    }\n\n    // DEPRECATED AND REMOVED METHODS\n\n    /**\n     * @deprecated\n     * Use {@link QuerySet#toModelArray} or predicate functions that\n     * instantiate Models from refs, e.g. `new Model(ref)`.\n     */\n    get withModels() {\n        throw new Error(\n            '`QuerySet.prototype.withModels` has been removed. ' +\n            'Use `.toModelArray()` or predicate functions that ' +\n            'instantiate Models from refs, e.g. `new Model(ref)`.'\n        );\n    }\n\n    /**\n     * @deprecated Query building operates on refs only now.\n     */\n    get withRefs() {\n        warnDeprecated(\n            '`QuerySet.prototype.withRefs` has been deprecated. ' +\n            'Query building operates on refs only now.'\n        );\n        return undefined;\n    }\n\n    /**\n     * @deprecated\n     * Call {@link QuerySet#toModelArray} or {@link QuerySet#toRefArray} first to map.\n     */\n    map() {\n        throw new Error(\n            '`QuerySet.prototype.map` has been removed. ' +\n            'Call `.toModelArray()` or `.toRefArray()` first to map.'\n        );\n    }\n\n    /**\n     * @deprecated\n     * Call {@link QuerySet#toModelArray} or {@link QuerySet#toRefArray} first to iterate.\n     */\n    forEach() {\n        throw new Error(\n            '`QuerySet.prototype.forEach` has been removed. ' +\n            'Call `.toModelArray()` or `.toRefArray()` first to iterate.'\n        );\n    }\n};\n\nQuerySet.sharedMethods = [\n    'count',\n    'at',\n    'all',\n    'last',\n    'first',\n    'filter',\n    'exclude',\n    'orderBy',\n    'update',\n    'delete',\n];\n\nexport default QuerySet;\n","import { getBatchToken } from 'immutable-ops';\n\nimport { SUCCESS, UPDATE, DELETE } from './constants';\nimport { warnDeprecated, clauseFiltersByAttribute } from './utils';\n\nconst Session = class Session {\n    /**\n     * Creates a new Session.\n     *\n     * @param  {Database} db - a {@link Database} instance\n     * @param  {Object} state - the database state\n     * @param  {Boolean} [withMutations] - whether the session should mutate data\n     * @param  {Object} [batchToken] - used by the backend to identify objects that can be\n     *                                 mutated.\n     */\n    constructor(schema, db, state, withMutations, batchToken) {\n        this.schema = schema;\n        this.db = db;\n        this.state = state || db.getEmptyState();\n        this.initialState = this.state;\n\n        this.withMutations = Boolean(withMutations);\n        this.batchToken = batchToken || getBatchToken();\n\n        this.modelData = {};\n\n        this.models = schema.getModelClasses();\n\n        this.sessionBoundModels = this.models.map((modelClass) => {\n            function SessionBoundModel() {\n                return Reflect.construct(modelClass, arguments, SessionBoundModel); // eslint-disable-line prefer-rest-params\n            }\n            Reflect.setPrototypeOf(SessionBoundModel.prototype, modelClass.prototype);\n            Reflect.setPrototypeOf(SessionBoundModel, modelClass);\n\n            Object.defineProperty(this, modelClass.modelName, {\n                get: () => SessionBoundModel,\n            });\n\n            SessionBoundModel.connect(this);\n            return SessionBoundModel;\n        });\n    }\n\n    getDataForModel(modelName) {\n        if (!this.modelData[modelName]) {\n            this.modelData[modelName] = {};\n        }\n        return this.modelData[modelName];\n    }\n\n    markAccessed(modelName, modelIds) {\n        const data = this.getDataForModel(modelName);\n        if (!data.accessedInstances) {\n            data.accessedInstances = {};\n        }\n        modelIds.forEach((id) => {\n            data.accessedInstances[id] = true;\n        });\n    }\n\n    get accessedModelInstances() {\n        return this.sessionBoundModels\n            .filter(({ modelName }) => this.getDataForModel(modelName).accessedInstances)\n            .reduce(\n                (result, { modelName }) => ({\n                    ...result,\n                    [modelName]: this.getDataForModel(modelName).accessedInstances,\n                }), {});\n    }\n\n    markFullTableScanned(modelName) {\n        const data = this.getDataForModel(modelName);\n        data.fullTableScanned = true;\n    }\n\n    get fullTableScannedModels() {\n        return this.sessionBoundModels\n            .filter(({ modelName }) => this.getDataForModel(modelName).fullTableScanned)\n            .map(({ modelName }) => modelName);\n    }\n\n    markAccessedIndexes(indexes) {\n        indexes.forEach(([table, attr, value]) => {\n            const data = this.getDataForModel(table);\n            if (!data.accessedIndexes) {\n                data.accessedIndexes = {};\n            }\n            data.accessedIndexes[attr] = [\n                ...(data.accessedIndexes[attr] || []),\n                value,\n            ];\n        });\n    }\n\n    get accessedIndexes() {\n        return this.sessionBoundModels\n            .filter(({ modelName }) => this.getDataForModel(modelName).accessedIndexes)\n            .reduce((result, { modelName }) => ({\n                ...result,\n                [modelName]: this.getDataForModel(modelName).accessedIndexes,\n            }), {});\n    }\n\n    /**\n     * Applies update to a model state.\n     *\n     * @private\n     * @param {Object} update - the update object. Must have keys\n     *                          `type`, `payload`.\n     */\n    applyUpdate(updateSpec) {\n        const tx = this._getTransaction(updateSpec);\n        const result = this.db.update(updateSpec, tx, this.state);\n        const { status, state, payload } = result;\n\n        if (status !== SUCCESS) {\n            throw new Error(`Applying update failed with status ${status}. Payload: ${payload}`);\n        }\n\n        this.state = state;\n\n        return payload;\n    }\n\n    query(querySpec) {\n        const result = this.db.query(querySpec, this.state);\n\n        this._markAccessedByQuery(querySpec, result);\n\n        return result;\n    }\n\n    _getTransaction(updateSpec) {\n        const { withMutations } = this;\n        const { action } = updateSpec;\n        let { batchToken } = this;\n        if ([UPDATE, DELETE].includes(action)) {\n            batchToken = getBatchToken();\n        }\n        return { batchToken, withMutations };\n    }\n\n    _markAccessedByQuery(querySpec, result) {\n        const { table, clauses } = querySpec;\n        const { rows } = result;\n\n        const { idAttribute } = this[table];\n        const accessedIds = new Set(rows.map(\n            row => row[idAttribute]\n        ));\n        const accessedIndexes = [];\n\n        const anyClauseFilteredById = clauses.some((clause) => {\n            if (!clauseFiltersByAttribute(clause, idAttribute)) {\n                return false;\n            }\n            const id = clause.payload[idAttribute];\n            if (id === null) return false;\n            /**\n             * we previously knew which row we wanted to access,\n             * so there was no need to scan the entire table\n             */\n            accessedIds.add(id);\n            return true;\n        });\n\n        const { indexes } = this.state[table];\n        clauses.forEach((clause) => {\n            Object.keys(indexes).forEach((attr) => {\n                if (!clauseFiltersByAttribute(clause, attr)) return;\n                const value = clause.payload[attr];\n                accessedIndexes.push([table, attr, value]);\n            });\n        });\n\n        if (anyClauseFilteredById) {\n            /**\n             * clauses have been ordered so that an indexed one was\n             * the first to be evaluated, and thus only the row\n             * with the specified id has actually been accessed\n             */\n            this.markAccessed(table, accessedIds);\n        } else if (accessedIndexes.length) {\n            this.markAccessedIndexes(accessedIndexes);\n        } else {\n            /**\n             * any other clause would have caused a full table scan,\n             * even if we specified an empty clauses array\n             */\n            this.markFullTableScanned(table);\n        }\n    }\n\n    // DEPRECATED AND REMOVED METHODS\n\n    /**\n     * @deprecated Access {@link Session#state} instead.\n     */\n    getNextState() {\n        warnDeprecated(\n            '`Session.prototype.getNextState` has been deprecated. Access ' +\n            'the `Session.prototype.state` property instead.'\n        );\n        return this.state;\n    }\n\n    /**\n     * @deprecated\n     * The Redux integration API is now decoupled from ORM and Session.<br>\n     * See the 0.9 migration guide in the GitHub repo.\n     */\n    reduce() {\n        throw new Error(\n            '`Session.prototype.reduce` has been removed. The Redux integration API ' +\n            'is now decoupled from ORM and Session - see the 0.9 migration guide ' +\n            'in the GitHub repo.'\n        );\n    }\n};\n\nexport default Session;\n","import {\n    normalizeEntity,\n} from './utils';\n\n/**\n * The functions in this file return custom JS property descriptors\n * that are supposed to be assigned to Model fields.\n *\n * Some include the logic to look up models using foreign keys and\n * to add or remove relationships between models.\n *\n * @module descriptors\n */\n\n/**\n * Defines a basic non-key attribute.\n * @param  {string} fieldName - the name of the field the descriptor will be assigned to.\n */\nfunction attrDescriptor(fieldName) {\n    return {\n        get() {\n            return this._fields[fieldName];\n        },\n\n        set(value) {\n            return this.set(fieldName, value);\n        },\n\n        enumerable: true,\n        configurable: true,\n    };\n}\n\n/**\n * Forwards direction of a Foreign Key: returns one object.\n * Also works as {@link .forwardsOneToOneDescriptor|forwardsOneToOneDescriptor}.\n *\n * For `book.author` referencing an `Author` model instance,\n * `fieldName` would be `'author'` and `declaredToModelName` would be `'Author'`.\n * @param  {string} fieldName - the name of the field the descriptor will be assigned to.\n * @param  {string} declaredToModelName - the name of the model that the field references.\n */\nfunction forwardsManyToOneDescriptor(fieldName, declaredToModelName) {\n    return {\n        get() {\n            const {\n                session: {\n                    [declaredToModelName]: DeclaredToModel,\n                },\n            } = this.getClass();\n            const {\n                [fieldName]: toId,\n            } = this._fields;\n\n            return DeclaredToModel.withId(toId);\n        },\n        set(value) {\n            this.update({\n                [fieldName]: normalizeEntity(value),\n            });\n        },\n    };\n}\n\n/**\n * Dereferencing foreign keys in {@link module:fields.oneToOne|oneToOne}\n * relationships works the same way as in many-to-one relationships:\n * just look up the related model.\n *\n * For example, a human face tends to have a single nose.\n * So if we want to resolve `face.nose`, we need to\n * look up the `Nose` that has the primary key that `face` references.\n *\n * @see {@link module:descriptors~forwardsManyToOneDescriptor|forwardsManyToOneDescriptor}\n */\nfunction forwardsOneToOneDescriptor(...args) {\n    return forwardsManyToOneDescriptor(...args);\n}\n\n/**\n * Here we resolve 1-to-1 relationships starting at the model on which the\n * field was not installed. This means we need to find the instance of the\n * other model whose {@link module:fields.oneToOne|oneToOne} FK field contains the current model's primary key.\n *\n * @param  {string} declaredFieldName - the name of the field referencing the current model.\n * @param  {string} declaredFromModelName - the name of the other model.\n */\nfunction backwardsOneToOneDescriptor(declaredFieldName, declaredFromModelName) {\n    return {\n        get() {\n            const {\n                session: {\n                    [declaredFromModelName]: DeclaredFromModel,\n                },\n            } = this.getClass();\n\n            return DeclaredFromModel.get({\n                [declaredFieldName]: this.getId(),\n            });\n        },\n        set() {\n            throw new Error('Can\\'t mutate a reverse one-to-one relation.');\n        },\n    };\n}\n\n/**\n * The backwards direction of a n-to-1 relationship (i.e. 1-to-n),\n * meaning this will return an a collection (`QuerySet`) of model instances.\n *\n * An example would be `author.books` referencing all instances of\n * the `Book` model that reference the author using `fk()`.\n */\nfunction backwardsManyToOneDescriptor(declaredFieldName, declaredFromModelName) {\n    return {\n        get() {\n            const {\n                session: {\n                    [declaredFromModelName]: DeclaredFromModel,\n                },\n            } = this.getClass();\n\n            return DeclaredFromModel.filter({\n                [declaredFieldName]: this.getId(),\n            });\n        },\n        set() {\n            throw new Error('Can\\'t mutate a reverse many-to-one relation.');\n        },\n    };\n}\n\n/**\n * This descriptor is assigned to both sides of a many-to-many relationship.\n * To indicate the backwards direction pass `true` for `reverse`.\n */\nfunction manyToManyDescriptor(\n    declaredFromModelName,\n    declaredToModelName,\n    throughModelName,\n    throughFields,\n    reverse\n) {\n    return {\n        get() {\n            const {\n                session: {\n                    [declaredFromModelName]: DeclaredFromModel,\n                    [declaredToModelName]: DeclaredToModel,\n                    [throughModelName]: ThroughModel,\n                },\n            } = this.getClass();\n\n            const ThisModel = reverse\n                ? DeclaredToModel\n                : DeclaredFromModel;\n            const OtherModel = reverse\n                ? DeclaredFromModel\n                : DeclaredToModel;\n\n            const thisReferencingField = reverse\n                ? throughFields.to\n                : throughFields.from;\n            const otherReferencingField = reverse\n                ? throughFields.from\n                : throughFields.to;\n\n            const thisId = this.getId();\n\n            const throughQs = ThroughModel.filter({\n                [thisReferencingField]: thisId,\n            });\n\n            /**\n             * all IDs of instances of the other model that are\n             * referenced by any instance of the current model\n             */\n            const referencedOtherIds = new Set(\n                throughQs\n                    .toRefArray()\n                    .map(obj => obj[otherReferencingField])\n            );\n\n            /**\n             * selects all instances of other model that are referenced\n             * by any instance of the current model\n             */\n            const qs = OtherModel.filter(otherModelInstance => (\n                referencedOtherIds.has(\n                    otherModelInstance[OtherModel.idAttribute]\n                )\n            ));\n\n            /**\n             * Allows adding OtherModel instances to be referenced by the current instance.\n             *\n             * E.g. Book.first().authors.add(1, 2) would add the authors with IDs 1 and 2\n             * to the first book's list of referenced authors.\n             *\n             * @return undefined\n             */\n            qs.add = function add(...entities) {\n                const idsToAdd = new Set(\n                    entities.map(normalizeEntity)\n                );\n\n                const existingQs = throughQs.filter(through => (\n                    idsToAdd.has(through[otherReferencingField])\n                ));\n\n                if (existingQs.exists()) {\n                    const existingIds = existingQs\n                        .toRefArray()\n                        .map(through => through[otherReferencingField]);\n\n                    throw new Error(`Tried to add already existing ${OtherModel.modelName} id(s) ${existingIds} to the ${ThisModel.modelName} instance with id ${thisId}`);\n                }\n\n                idsToAdd.forEach((id) => {\n                    ThroughModel.create({\n                        [otherReferencingField]: id,\n                        [thisReferencingField]: thisId,\n                    });\n                });\n            };\n\n            /**\n             * Removes references to all OtherModel instances from the current model.\n             *\n             * E.g. Book.first().authors.clear() would cause the first book's list\n             * of referenced authors to become empty.\n             *\n             * @return undefined\n             */\n            qs.clear = function clear() {\n                throughQs.delete();\n            };\n\n            /**\n             * Removes references to all passed OtherModel instances from the current model.\n             *\n             * E.g. Book.first().authors.remove(1, 2) would cause the authors with\n             * IDs 1 and 2 to no longer be referenced by the first book.\n             *\n             * @return undefined\n             */\n            qs.remove = function remove(...entities) {\n                const idsToRemove = new Set(\n                    entities.map(normalizeEntity)\n                );\n\n                const entitiesToDelete = throughQs.filter(\n                    through => idsToRemove.has(through[otherReferencingField])\n                );\n\n                if (entitiesToDelete.count() !== idsToRemove.size) {\n                    // Tried deleting non-existing entities.\n                    const entitiesToDeleteIds = entitiesToDelete\n                        .toRefArray()\n                        .map(through => through[otherReferencingField]);\n\n                    const unexistingIds = [...idsToRemove].filter(\n                        id => !entitiesToDeleteIds.includes(id)\n                    );\n\n                    throw new Error(`Tried to delete non-existing ${OtherModel.modelName} id(s) ${unexistingIds} from the ${ThisModel.modelName} instance with id ${thisId}`);\n                }\n\n                entitiesToDelete.delete();\n            };\n\n            return qs;\n        },\n\n        set() {\n            throw new Error('Tried setting a M2M field. Please use the related QuerySet methods add, remove and clear.');\n        },\n    };\n}\n\nexport {\n    attrDescriptor,\n    forwardsManyToOneDescriptor,\n    forwardsOneToOneDescriptor,\n    backwardsOneToOneDescriptor,\n    backwardsManyToOneDescriptor,\n    manyToManyDescriptor,\n};\n","import {\n    attrDescriptor,\n    forwardsManyToOneDescriptor,\n    backwardsManyToOneDescriptor,\n    forwardsOneToOneDescriptor,\n    backwardsOneToOneDescriptor,\n    manyToManyDescriptor,\n} from './descriptors';\n\nimport {\n    m2mName,\n    m2mToFieldName,\n    m2mFromFieldName,\n    reverseFieldName,\n    reverseFieldErrorMessage,\n} from './utils';\n\n/**\n * Contains the logic for how fields on {@link Model}s work\n * and which descriptors must be installed.\n *\n * If your goal is to define fields on a Model class,\n * please use the more convenient methods {@link attr},\n * {@link fk}, {@link many} and {@link oneToOne}.\n *\n * @module fields\n */\n\n/**\n * Defines algorithm for installing a field onto a model and related models.\n * Conforms to the template method behavioral design pattern.\n * @private\n */\nclass FieldInstallerTemplate {\n    constructor(opts) {\n        this.field = opts.field;\n        this.fieldName = opts.fieldName;\n        this.model = opts.model;\n        this.orm = opts.orm;\n        /**\n         * the field itself has no knowledge of the model\n         * it is being installed upon; we need to inform it\n         * that it is a self-referencing field for the field\n         * to be able to make better informed decisions\n         */\n        if (this.field.references(this.model)) {\n            this.field.toModelName = 'this';\n        }\n    }\n\n    get toModel() {\n        if (typeof this._toModel === 'undefined') {\n            const { toModelName } = this.field;\n            if (!toModelName) {\n                this._toModel = null;\n            } else if (toModelName === 'this') {\n                this._toModel = this.model;\n            } else {\n                this._toModel = this.orm.get(toModelName);\n            }\n        }\n        return this._toModel;\n    }\n\n    get throughModel() {\n        if (typeof this._throughModel === 'undefined') {\n            const throughModelName = this.field.getThroughModelName(\n                this.fieldName,\n                this.model\n            );\n            if (!throughModelName) {\n                this._throughModel = null;\n            } else {\n                this._throughModel = this.orm.get(throughModelName);\n            }\n        }\n        return this._throughModel;\n    }\n\n    get backwardsFieldName() {\n        return this.field.getBackwardsFieldName(this.model);\n    }\n\n    run() {\n        if (this.field.installsForwardsDescriptor) {\n            this.installForwardsDescriptor();\n        }\n        if (this.field.installsForwardsVirtualField) {\n            this.installForwardsVirtualField();\n        }\n        /**\n         * Install a backwards field on a model as a consequence\n         * of having installed the forwards field on another model.\n         */\n        if (this.field.installsBackwardsDescriptor) {\n            this.installBackwardsDescriptor();\n        }\n        if (this.field.installsBackwardsVirtualField) {\n            this.installBackwardsVirtualField();\n        }\n    }\n}\n\n/**\n * Default implementation for the template method in FieldInstallerTemplate.\n * @private\n */\nclass DefaultFieldInstaller extends FieldInstallerTemplate {\n    installForwardsDescriptor() {\n        Object.defineProperty(\n            this.model.prototype,\n            this.fieldName,\n            this.field.createForwardsDescriptor(\n                this.fieldName,\n                this.model,\n                this.toModel,\n                this.throughModel\n            )\n        );\n    }\n\n    installForwardsVirtualField() {\n        this.model.virtualFields[this.fieldName] = this.field.createForwardsVirtualField(\n            this.fieldName,\n            this.model,\n            this.toModel,\n            this.throughModel\n        );\n    }\n\n    installBackwardsDescriptor() {\n        const backwardsDescriptor = Object.getOwnPropertyDescriptor(\n            this.toModel.prototype,\n            this.backwardsFieldName\n        );\n        if (backwardsDescriptor) {\n            throw new Error(reverseFieldErrorMessage(\n                this.model.modelName,\n                this.fieldName,\n                this.toModel.modelName,\n                this.backwardsFieldName\n            ));\n        }\n\n        // install backwards descriptor\n        Object.defineProperty(\n            this.toModel.prototype,\n            this.backwardsFieldName,\n            this.field.createBackwardsDescriptor(\n                this.fieldName,\n                this.model,\n                this.toModel,\n                this.throughModel\n            )\n        );\n    }\n\n    installBackwardsVirtualField() {\n        this.toModel.virtualFields[this.backwardsFieldName] = this.field.createBackwardsVirtualField(\n            this.fieldName,\n            this.model,\n            this.toModel,\n            this.throughModel\n        );\n    }\n}\n\n/**\n * @ignore\n */\nclass Field {\n    constructor() {\n        this.index = false;\n    }\n\n    get installerClass() {\n        return DefaultFieldInstaller;\n    }\n\n    getClass() {\n        return this.constructor;\n    }\n\n    references(model) {\n        return false;\n    }\n\n    getThroughModelName(fieldName, model) {\n        return null;\n    }\n\n    get installsForwardsDescriptor() {\n        return true;\n    }\n\n    get installsForwardsVirtualField() {\n        return false;\n    }\n\n    get installsBackwardsDescriptor() {\n        return false;\n    }\n\n    get installsBackwardsVirtualField() {\n        return false;\n    }\n}\n\n/**\n * @ignore\n */\nexport class Attribute extends Field {\n    constructor(opts) {\n        super();\n        this.opts = opts || {};\n\n        if (this.opts.hasOwnProperty('getDefault')) {\n            this.getDefault = this.opts.getDefault;\n        }\n    }\n\n    createForwardsDescriptor(fieldName, model) {\n        return attrDescriptor(fieldName);\n    }\n}\n\n/**\n * @ignore\n */\nclass RelationalField extends Field {\n    constructor(...args) {\n        super();\n        if (args.length === 1 && typeof args[0] === 'object') {\n            const opts = args[0];\n            this.toModelName = opts.to;\n            this.relatedName = opts.relatedName;\n            this.through = opts.through;\n            this.throughFields = opts.throughFields;\n            this.as = opts.as;\n        } else {\n            [this.toModelName, this.relatedName] = args;\n        }\n    }\n\n    getBackwardsFieldName(model) {\n        return (\n            this.relatedName ||\n            reverseFieldName(model.modelName)\n        );\n    }\n\n    createBackwardsVirtualField(fieldName, model, toModel, throughModel) {\n        const ThisField = this.getClass();\n        return new ThisField(model.modelName, fieldName);\n    }\n\n    get installsBackwardsVirtualField() {\n        return true;\n    }\n\n    get installsBackwardsDescriptor() {\n        return true;\n    }\n\n    references(model) {\n        return this.toModelName === model.modelName;\n    }\n\n    get installerClass() {\n        return class AliasedForwardsDescriptorInstaller extends DefaultFieldInstaller {\n            installForwardsDescriptor() {\n                Object.defineProperty(\n                    this.model.prototype,\n                    this.field.as || this.fieldName, // use supplied name if possible\n                    this.field.createForwardsDescriptor(\n                        this.fieldName,\n                        this.model,\n                        this.toModel,\n                        this.throughModel\n                    )\n                );\n            }\n        };\n    }\n}\n\n/**\n * @ignore\n */\nexport class ForeignKey extends RelationalField {\n    constructor(...args) {\n        super(...args);\n        this.index = true;\n    }\n\n    createForwardsDescriptor(fieldName, model, toModel, throughModel) {\n        return forwardsManyToOneDescriptor(fieldName, toModel.modelName);\n    }\n\n    createBackwardsDescriptor(fieldName, model, toModel, throughModel) {\n        return backwardsManyToOneDescriptor(fieldName, model.modelName);\n    }\n}\n\n/**\n * @ignore\n */\nexport class ManyToMany extends RelationalField {\n    getDefault() {\n        return [];\n    }\n\n    getThroughModelName(fieldName, model) {\n        return (\n            this.through ||\n            m2mName(model.modelName, fieldName)\n        );\n    }\n\n    createForwardsDescriptor(fieldName, model, toModel, throughModel) {\n        return manyToManyDescriptor(\n            model.modelName,\n            toModel.modelName,\n            throughModel.modelName,\n            this.getThroughFields(fieldName, model, toModel, throughModel),\n            false\n        );\n    }\n\n    createBackwardsDescriptor(fieldName, model, toModel, throughModel) {\n        return manyToManyDescriptor(\n            model.modelName,\n            toModel.modelName,\n            throughModel.modelName,\n            this.getThroughFields(fieldName, model, toModel, throughModel),\n            true\n        );\n    }\n\n    createBackwardsVirtualField(fieldName, model, toModel, throughModel) {\n        const ThisField = this.getClass();\n        return new ThisField({\n            to: model.modelName,\n            relatedName: fieldName,\n            through: throughModel.modelName,\n            throughFields: this.getThroughFields(fieldName, model, toModel, throughModel),\n        });\n    }\n\n    createForwardsVirtualField(fieldName, model, toModel, throughModel) {\n        const ThisField = this.getClass();\n        return new ThisField({\n            to: toModel.modelName,\n            relatedName: fieldName,\n            through: this.through,\n            throughFields: this.getThroughFields(fieldName, model, toModel, throughModel),\n        });\n    }\n\n    get installsForwardsVirtualField() {\n        return true;\n    }\n\n    getThroughFields(fieldName, model, toModel, throughModel) {\n        if (this.throughFields) {\n            const [fieldAName, fieldBName] = this.throughFields;\n            const fieldA = throughModel.fields[fieldAName];\n            return {\n                to: fieldA.references(toModel) ? fieldAName : fieldBName,\n                from: fieldA.references(toModel) ? fieldBName : fieldAName,\n            };\n        }\n\n        if (model.modelName === toModel.modelName) {\n            /**\n             * we have no way of determining the relationship's\n             * direction here, so we need to assume that the user\n             * did not use a custom through model\n             * see ORM#registerManyToManyModelsFor\n             */\n            return {\n                to: m2mToFieldName(toModel.modelName),\n                from: m2mFromFieldName(model.modelName),\n            };\n        }\n\n        /**\n         * determine which field references which model\n         * and infer the directions from that\n         */\n        const throughModelFieldReferencing = otherModel => (\n            Object.keys(throughModel.fields).find(someFieldName => (\n                throughModel.fields[someFieldName].references(otherModel)\n            ))\n        );\n\n        return {\n            to: throughModelFieldReferencing(toModel),\n            from: throughModelFieldReferencing(model),\n        };\n    }\n}\n\n/**\n * @ignore\n */\nexport class OneToOne extends RelationalField {\n    getBackwardsFieldName(model) {\n        return (\n            this.relatedName ||\n            model.modelName.toLowerCase()\n        );\n    }\n\n    createForwardsDescriptor(fieldName, model, toModel, throughModel) {\n        return forwardsOneToOneDescriptor(fieldName, toModel.modelName);\n    }\n\n    createBackwardsDescriptor(fieldName, model, toModel, throughModel) {\n        return backwardsOneToOneDescriptor(fieldName, model.modelName);\n    }\n}\n\n/**\n * Defines a value attribute on the model.\n * Though not required, it is recommended to define this for each non-foreign key you wish to use.\n * Getters and setters need to be defined on each Model\n * instantiation for undeclared data fields, which is slower.\n * You can use the optional `getDefault` parameter to fill in unpassed values\n * to {@link Model.create}, such as for generating ID's with UUID:\n *\n * ```javascript\n * import getUUID from 'your-uuid-package-of-choice';\n *\n * fields = {\n *   id: attr({ getDefault: () => getUUID() }),\n *   title: attr(),\n * }\n * ```\n *\n * @global\n *\n * @param  {Object} [opts]\n * @param {Function} [opts.getDefault] - if you give a function here, it's return\n *                                       value from calling with zero arguments will\n *                                       be used as the value when creating a new Model\n *                                       instance with {@link Model#create} if the field\n *                                       value is not passed.\n * @return {Attribute}\n */\nexport function attr(opts) {\n    return new Attribute(opts);\n}\n\n/**\n * Defines a foreign key on a model, which points\n * to a single entity on another model.\n *\n * You can pass arguments as either a single object,\n * or two arguments.\n *\n * If you pass two arguments, the first one is the name\n * of the Model the foreign key is pointing to, and\n * the second one is an optional related name, which will\n * be used to access the Model the foreign key\n * is being defined from, from the target Model.\n *\n * If the related name is not passed, it will be set as\n * `${toModelName}Set`.\n *\n * If you pass an object to `fk`, it has to be in the form\n *\n * ```javascript\n * fields = {\n *   author: fk({ to: 'Author', relatedName: 'books' })\n * }\n * ```\n *\n * Which is equal to\n *\n * ```javascript\n * fields = {\n *   author: fk('Author', 'books'),\n * }\n * ```\n *\n * @global\n *\n * @param  {string|Object} toModelNameOrObj - the `modelName` property of\n *                                            the Model that is the target of the\n *                                            foreign key, or an object with properties\n *                                            `to` and optionally `relatedName`.\n * @param {string} [relatedName] - if you didn't pass an object as the first argument,\n *                                 this is the property name that will be used to\n *                                 access a QuerySet the foreign key is defined from,\n *                                 from the target model.\n * @return {ForeignKey}\n */\nexport function fk(...args) {\n    return new ForeignKey(...args);\n}\n\n/**\n * Defines a many-to-many relationship between\n * this (source) and another (target) model.\n *\n * The relationship is modeled with an extra model called the through model.\n * The through model has foreign keys to both the source and target models.\n *\n * You can define your own through model if you want to associate more information\n * to the relationship. A custom through model must have at least two foreign keys,\n * one pointing to the source Model, and one pointing to the target Model.\n *\n * If you have more than one foreign key pointing to a source or target Model in the\n * through Model, you must pass the option `throughFields`, which is an array of two\n * strings, where the strings are the field names that identify the foreign keys to\n * be used for the many-to-many relationship. Redux-ORM will figure out which field name\n * points to which model by checking the through Model definition.\n *\n * Unlike `fk`, this function accepts only an object argument.\n *\n * ```javascript\n * class Authorship extends Model {}\n * Authorship.modelName = 'Authorship';\n * Authorship.fields = {\n *   author: fk('Author', 'authorships'),\n *   book: fk('Book', 'authorships'),\n * };\n *\n * class Author extends Model {}\n * Author.modelName = 'Author';\n * Author.fields = {\n *   books: many({\n *     to: 'Book',\n *     relatedName: 'authors',\n *     through: 'Authorship',\n *\n *     // this is optional, since Redux-ORM can figure\n *     // out the through fields itself as there aren't\n *     // multiple foreign keys pointing to the same models.\n *     throughFields: ['author', 'book'],\n *   })\n * };\n *\n * class Book extends Model {}\n * Book.modelName = 'Book';\n * ```\n *\n * You should only define the many-to-many relationship on one side. In the\n * above case of Authors to Books through Authorships, the relationship is\n * defined only on the Author model.\n *\n * @global\n *\n * @param  {Object} options - options\n * @param  {string} options.to - the `modelName` attribute of the target Model.\n * @param  {string} [options.through] - the `modelName` attribute of the through Model which\n *                                    must declare at least one foreign key to both source and\n *                                    target Models. If not supplied, Redux-Orm will autogenerate\n *                                    one.\n * @param  {string[]} [options.throughFields] - this must be supplied only when a custom through\n *                                            Model has more than one foreign key pointing to\n *                                            either the source or target mode. In this case\n *                                            Redux-ORM can't figure out the correct fields for\n *                                            you, you must provide them. The supplied array should\n *                                            have two elements that are the field names for the\n *                                            through fields you want to declare the many-to-many\n *                                            relationship with. The order doesn't matter;\n *                                            Redux-ORM will figure out which field points to\n *                                            the source Model and which to the target Model.\n * @param  {string} [options.relatedName] - the attribute used to access a QuerySet\n *                                          of source Models from target Model.\n * @return {ManyToMany}\n */\nexport function many(...args) {\n    return new ManyToMany(...args);\n}\n\n/**\n * Defines a one-to-one relationship. In database terms, this is a foreign key with the\n * added restriction that only one entity can point to single target entity.\n *\n * The arguments are the same as with `fk`. If `relatedName` is not supplied,\n * the source model name in lowercase will be used. Note that with the one-to-one\n * relationship, the `relatedName` should be in singular, not plural.\n *\n * @global\n *\n * @param  {string|Object} toModelNameOrObj - the `modelName` property of\n *                                            the Model that is the target of the\n *                                            foreign key, or an object with properties\n *                                            `to` and optionally `relatedName`.\n * @param {string} [relatedName] - if you didn't pass an object as the first argument,\n *                                 this is the property name that will be used to\n *                                 access a Model the foreign key is defined from,\n *                                 from the target Model.\n * @return {OneToOne}\n */\nexport function oneToOne(...args) {\n    return new OneToOne(...args);\n}\n","import Session from './Session';\nimport QuerySet from './QuerySet';\nimport {\n    ManyToMany,\n    ForeignKey,\n    OneToOne,\n    attr,\n} from './fields';\nimport {\n    CREATE, UPDATE, DELETE, FILTER,\n} from './constants';\nimport {\n    normalizeEntity,\n    arrayDiffActions,\n    objectShallowEquals,\n    warnDeprecated,\n    m2mName,\n} from './utils';\n\n\n/**\n * Generates a query specification to get the instance's\n * corresponding table row using its primary key.\n *\n * @private\n * @returns {Object}\n */\nfunction getByIdQuery(modelInstance) {\n    const modelClass = modelInstance.getClass();\n    const { idAttribute, modelName } = modelClass;\n\n    return {\n        table: modelName,\n        clauses: [\n            {\n                type: FILTER,\n                payload: {\n                    [idAttribute]: modelInstance.getId(),\n                },\n            },\n        ],\n    };\n}\n\n\n/**\n * The heart of an ORM, the data model.\n *\n * The fields you specify to the Model will be used to generate\n * a schema to the database, related property accessors, and\n * possibly through models.\n *\n * In each {@link Session} you instantiate from an {@link ORM} instance,\n * you will receive a session-specific subclass of this Model. The methods\n * you define here will be available to you in sessions.\n *\n * An instance of {@link Model} represents a record in the database, though\n * it is possible to generate multiple instances from the same record in the database.\n *\n * To create data models in your schema, subclass {@link Model}. To define\n * information about the data model, override static class methods. Define instance\n * logic by defining prototype methods (without `static` keyword).\n */\nconst Model = class Model {\n    /**\n     * Creates a Model instance from it's properties.\n     * Don't use this to create a new record; Use the static method {@link Model#create}.\n     * @param  {Object} props - the properties to instantiate with\n     */\n    constructor(props) {\n        this._initFields(props);\n    }\n\n    _initFields(props) {\n        const propsObj = Object(props);\n        this._fields = { ...propsObj };\n\n        Object.keys(propsObj).forEach((fieldName) => {\n            // In this case, we got a prop that wasn't defined as a field.\n            // Assuming it's an arbitrary data field, making an instance-specific\n            // descriptor for it.\n            // Using the in operator as the property could be defined anywhere\n            // on the prototype chain.\n            if (!(fieldName in this)) {\n                Object.defineProperty(this, fieldName, {\n                    get: () => this._fields[fieldName],\n                    set: value => this.set(fieldName, value),\n                    configurable: true,\n                    enumerable: true,\n                });\n            }\n        });\n    }\n\n    static toString() {\n        return `ModelClass: ${this.modelName}`;\n    }\n\n    /**\n     * Returns the options object passed to the database for the table that represents\n     * this Model class.\n     *\n     * Returns an empty object by default, which means the database\n     * will use default options. You can either override this function to return the options\n     * you want to use, or assign the options object as a static property of the same name to the\n     * Model class.\n     *\n     * @return {Object} the options object passed to the database for the table\n     *                  representing this Model class.\n     */\n    static options() {\n        return {};\n    }\n\n    /**\n     * Manually mark individual instances as accessed.\n     * This allows invalidating selector memoization within mutable sessions.\n     *\n     * @param {Array.<*>} ids - Array of primary key values\n     * @return {undefined}\n     */\n    static markAccessed(ids) {\n        if (typeof this._session === 'undefined') {\n            throw new Error([\n                `Tried to mark rows of the ${this.modelName} model as accessed without a session. `,\n                'Create a session using `session = orm.session()` and call ',\n                `\\`session[\"${this.modelName}\"].markAccessed\\` instead.`,\n            ].join(''));\n        }\n        this.session.markAccessed(this.modelName, ids);\n    }\n\n    /**\n     * Manually mark this model's table as scanned.\n     * This allows invalidating selector memoization within mutable sessions.\n     *\n     * @return {undefined}\n     */\n    static markFullTableScanned() {\n        if (typeof this._session === 'undefined') {\n            throw new Error([\n                `Tried to mark the ${this.modelName} model as full table scanned without a session. `,\n                'Create a session using `session = orm.session()` and call ',\n                `\\`session[\"${this.modelName}\"].markFullTableScanned\\` instead.`,\n            ].join(''));\n        }\n        this.session.markFullTableScanned(this.modelName);\n    }\n\n    /**\n     * Manually mark indexes as accessed.\n     * This allows invalidating selector memoization within mutable sessions.\n     *\n     * @param {Array.<Array.<*,*>>} indexes - Array of column-value pairs\n     * @return {undefined}\n     */\n    static markAccessedIndexes(indexes) {\n        if (typeof this._session === 'undefined') {\n            throw new Error([\n                `Tried to mark indexes for the ${this.modelName} model as accessed without a session. `,\n                'Create a session using `session = orm.session()` and call ',\n                `\\`session[\"${this.modelName}\"].markAccessedIndexes\\` instead.`,\n            ].join(''));\n        }\n        this.session.markAccessedIndexes(\n            indexes.map(\n                ([attribute, value]) => [this.modelName, attribute, value]\n            )\n        );\n    }\n\n    /**\n     * Returns the id attribute of this {@link Model}.\n     *\n     * @return {string} The id attribute of this {@link Model}.\n     */\n    static get idAttribute() {\n        if (typeof this._session === 'undefined') {\n            throw new Error([\n                `Tried to get the ${this.modelName} model's id attribute without a session. `,\n                'Create a session using `session = orm.session()` and access ',\n                `\\`session[\"${this.modelName}\"].idAttribute\\` instead.`,\n            ].join(''));\n        }\n        return this.session.db.describe(this.modelName).idAttribute;\n    }\n\n    /**\n     * Connect the model class to a {@link Session}.\n     *\n     * @private\n     * @param  {Session} session - The session to connect to.\n     */\n    static connect(session) {\n        if (!(session instanceof Session)) {\n            throw new Error('A model can only be connected to instances of Session.');\n        }\n        this._session = session;\n    }\n\n    /**\n     * Get the current {@link Session} instance.\n     *\n     * @private\n     * @return {Session} The current {@link Session} instance.\n     */\n    static get session() {\n        return this._session;\n    }\n\n    /**\n     * Returns an instance of the model's `querySetClass` field.\n     * By default, this will be an empty {@link QuerySet}.\n     *\n     * @return {Object} An instance of the model's `querySetClass`.\n     */\n    static getQuerySet() {\n        const { querySetClass: QuerySetClass } = this;\n        return new QuerySetClass(this);\n    }\n\n    /**\n     * @return {undefined}\n     */\n    static invalidateClassCache() {\n        this.isSetUp = undefined;\n        this.virtualFields = {};\n    }\n\n    /**\n     * @see {@link Model.getQuerySet}\n     */\n    static get query() {\n        return this.getQuerySet();\n    }\n\n    /**\n     * @private\n     */\n    static _getTableOpts() {\n        if (typeof this.backend === 'function') {\n            warnDeprecated('`Model.backend` has been deprecated. Please rename to `.options`.');\n            return this.backend();\n        }\n        if (this.backend) {\n            warnDeprecated('`Model.backend` has been deprecated. Please rename to `.options`.');\n            return this.backend;\n        }\n        if (typeof this.options === 'function') {\n            return this.options();\n        }\n        return this.options;\n    }\n\n    /**\n     * Creates a new record in the database, instantiates a {@link Model} and returns it.\n     *\n     * If you pass values for many-to-many fields, instances are created on the through\n     * model as well.\n     *\n     * @param  {props} userProps - the new {@link Model}'s properties.\n     * @return {Model} a new {@link Model} instance.\n     */\n    static create(userProps) {\n        if (typeof this._session === 'undefined') {\n            throw new Error([\n                `Tried to create a ${this.modelName} model instance without a session. `,\n                'Create a session using `session = orm.session()` and call ',\n                `\\`session[\"${this.modelName}\"].create\\` instead.`,\n            ].join(''));\n        }\n        const props = { ...userProps };\n\n        const m2mRelations = {};\n\n        const declaredFieldNames = Object.keys(this.fields);\n        const declaredVirtualFieldNames = Object.keys(this.virtualFields);\n\n        declaredFieldNames.forEach((key) => {\n            const field = this.fields[key];\n            const valuePassed = userProps.hasOwnProperty(key);\n            if (!(field instanceof ManyToMany)) {\n                if (valuePassed) {\n                    const value = userProps[key];\n                    props[key] = normalizeEntity(value);\n                } else if (field.getDefault) {\n                    props[key] = field.getDefault();\n                }\n            } else if (valuePassed) {\n                // If a value is supplied for a ManyToMany field,\n                // discard them from props and save for later processing.\n                m2mRelations[key] = userProps[key];\n                delete props[key];\n            }\n        });\n\n        // add backward many-many if required\n        declaredVirtualFieldNames.forEach((key) => {\n            if (!m2mRelations.hasOwnProperty(key)) {\n                const field = this.virtualFields[key];\n                if (userProps.hasOwnProperty(key) && field instanceof ManyToMany) {\n                    // If a value is supplied for a ManyToMany field,\n                    // discard them from props and save for later processing.\n                    m2mRelations[key] = userProps[key];\n                    delete props[key];\n                }\n            }\n        });\n\n        const newEntry = this.session.applyUpdate({\n            action: CREATE,\n            table: this.modelName,\n            payload: props,\n        });\n\n        const ThisModel = this;\n        const instance = new ThisModel(newEntry);\n        instance._refreshMany2Many(m2mRelations); // eslint-disable-line no-underscore-dangle\n        return instance;\n    }\n\n    /**\n     * Creates a new or update existing record in the database, instantiates a {@link Model} and returns it.\n     *\n     * If you pass values for many-to-many fields, instances are created on the through\n     * model as well.\n     *\n     * @param  {props} userProps - the required {@link Model}'s properties.\n     * @return {Model} a {@link Model} instance.\n     */\n    static upsert(userProps) {\n        if (typeof this.session === 'undefined') {\n            throw new Error([\n                `Tried to upsert a ${this.modelName} model instance without a session. `,\n                'Create a session using `session = orm.session()` and call ',\n                `\\`session[\"${this.modelName}\"].upsert\\` instead.`,\n            ].join(''));\n        }\n\n        const { idAttribute } = this;\n        if (userProps.hasOwnProperty(idAttribute)) {\n            const id = userProps[idAttribute];\n            if (this.idExists(id)) {\n                const model = this.withId(id);\n                model.update(userProps);\n                return model;\n            }\n        }\n\n        return this.create(userProps);\n    }\n\n    /**\n     * Returns a {@link Model} instance for the object with id `id`.\n     * Returns `null` if the model has no instance with id `id`.\n     *\n     * You can use {@link Model#idExists} to check for existence instead.\n     *\n     * @param  {*} id - the `id` of the object to get\n     * @throws If object with id `id` doesn't exist\n     * @return {Model|null} {@link Model} instance with id `id`\n     */\n    static withId(id) {\n        return this.get({\n            [this.idAttribute]: id,\n        });\n    }\n\n    /**\n     * Returns a boolean indicating if an entity\n     * with the id `id` exists in the state.\n     *\n     * @param  {*}  id - a value corresponding to the id attribute of the {@link Model} class.\n     * @return {Boolean} a boolean indicating if entity with `id` exists in the state\n     *\n     * @since 0.11.0\n     */\n    static idExists(id) {\n        return this.exists({\n            [this.idAttribute]: id,\n        });\n    }\n\n    /**\n     * Returns a boolean indicating if an entity\n     * with the given props exists in the state.\n     *\n     * @param  {*}  props - a key-value that {@link Model} instances should have to be considered as existing.\n     * @return {Boolean} a boolean indicating if entity with `props` exists in the state\n     */\n    static exists(lookupObj) {\n        if (typeof this.session === 'undefined') {\n            throw new Error([\n                `Tried to check if a ${this.modelName} model instance exists without a session. `,\n                'Create a session using `session = orm.session()` and call ',\n                `\\`session[\"${this.modelName}\"].exists\\` instead.`,\n            ].join(''));\n        }\n\n        return Boolean(\n            this._findDatabaseRows(lookupObj).length\n        );\n    }\n\n    /**\n     * Gets the {@link Model} instance that matches properties in `lookupObj`.\n     * Throws an error if {@link Model} if multiple records match\n     * the properties.\n     *\n     * @param  {Object} lookupObj - the properties used to match a single entity.\n     * @throws {Error} If more than one entity matches the properties in `lookupObj`.\n     * @return {Model} a {@link Model} instance that matches the properties in `lookupObj`.\n     */\n    static get(lookupObj) {\n        const ThisModel = this;\n\n        const rows = this._findDatabaseRows(lookupObj);\n        if (rows.length === 0) {\n            return null;\n        }\n        if (rows.length > 1) {\n            throw new Error(`Expected to find a single row in \\`${this.modelName}.get\\`. Found ${rows.length}.`);\n        }\n\n        return new ThisModel(rows[0]);\n    }\n\n    /**\n     * Gets the {@link Model} class or subclass constructor (the class that\n     * instantiated this instance).\n     *\n     * @return {Model} The {@link Model} class or subclass constructor used to instantiate\n     *                 this instance.\n     */\n    getClass() {\n        return this.constructor;\n    }\n\n    /**\n     * Gets the id value of the current instance by looking up the id attribute.\n     * @return {*} The id value of the current instance.\n     */\n    getId() {\n        return this._fields[this.getClass().idAttribute];\n    }\n\n    /**\n     * Returns a reference to the plain JS object in the store.\n     * Make sure to not mutate this.\n     *\n     * @return {Object} a reference to the plain JS object in the store\n     */\n    get ref() {\n        const ThisModel = this.getClass();\n\n        // eslint-disable-next-line no-underscore-dangle\n        return ThisModel._findDatabaseRows({\n            [ThisModel.idAttribute]: this.getId(),\n        })[0];\n    }\n\n    /**\n     * Finds all rows in this model's table that match the given `lookupObj`.\n     * If no `lookupObj` is passed, all rows in the model's table will be returned.\n     *\n     * @param  {*}  props - a key-value that {@link Model} instances should have to be considered as existing.\n     * @return {Boolean} a boolean indicating if entity with `props` exists in the state\n     * @private\n     */\n    static _findDatabaseRows(lookupObj) {\n        const querySpec = {\n            table: this.modelName,\n        };\n        if (lookupObj) {\n            querySpec.clauses = [\n                {\n                    type: FILTER,\n                    payload: lookupObj,\n                },\n            ];\n        }\n        return this.session.query(querySpec).rows;\n    }\n\n    /**\n     * Returns a string representation of the {@link Model} instance.\n     *\n     * @return {string} A string representation of this {@link Model} instance.\n     */\n    toString() {\n        const ThisModel = this.getClass();\n        const className = ThisModel.modelName;\n        const fieldNames = Object.keys(ThisModel.fields);\n        const fields = fieldNames.map((fieldName) => {\n            const field = ThisModel.fields[fieldName];\n            if (field instanceof ManyToMany) {\n                const ids = this[fieldName].toModelArray().map(\n                    model => model.getId()\n                );\n                return `${fieldName}: [${ids.join(', ')}]`;\n            }\n            const val = this._fields[fieldName];\n            return `${fieldName}: ${val}`;\n        }).join(', ');\n        return `${className}: {${fields}}`;\n    }\n\n    /**\n     * Returns a boolean indicating if `otherModel` equals this {@link Model} instance.\n     * Equality is determined by shallow comparing their attributes.\n     *\n     * This equality is used when you call {@link Model#update}.\n     * You can prevent model updates by returning `true` here.\n     * However, a model will always be updated if its relationships are changed.\n     *\n     * @param  {Model} otherModel - a {@link Model} instance to compare\n     * @return {Boolean} a boolean indicating if the {@link Model} instance's are equal.\n     */\n    equals(otherModel) {\n        // eslint-disable-next-line no-underscore-dangle\n        return objectShallowEquals(this._fields, otherModel._fields);\n    }\n\n    /**\n     * Updates a property name to given value for this {@link Model} instance.\n     * The values are immediately committed to the database.\n     *\n     * @param {string} propertyName - name of the property to set\n     * @param {*} value - value assigned to the property\n     * @return {undefined}\n     */\n    set(propertyName, value) {\n        this.update({\n            [propertyName]: value,\n        });\n    }\n\n    /**\n     * Assigns multiple fields and corresponding values to this {@link Model} instance.\n     * The updates are immediately committed to the database.\n     *\n     * @param  {Object} userMergeObj - an object that will be merged with this instance.\n     * @return {undefined}\n     */\n    update(userMergeObj) {\n        const ThisModel = this.getClass();\n        if (typeof ThisModel.session === 'undefined') {\n            throw new Error([\n                `Tried to update a ${ThisModel.modelName} model instance without a session. `,\n                'You cannot call `.update` on an instance that you did not receive from the database.',\n            ].join(''));\n        }\n\n        const mergeObj = { ...userMergeObj };\n\n        const { fields, virtualFields } = ThisModel;\n\n        const m2mRelations = {};\n\n        // If an array of entities or id's is supplied for a\n        // many-to-many related field, clear the old relations\n        // and add the new ones.\n        for (const mergeKey in mergeObj) { // eslint-disable-line no-restricted-syntax, guard-for-in\n            const isRealField = fields.hasOwnProperty(mergeKey);\n\n            if (isRealField) {\n                const field = fields[mergeKey];\n\n                if (field instanceof ForeignKey || field instanceof OneToOne) {\n                    // update one-one/fk relations\n                    mergeObj[mergeKey] = normalizeEntity(mergeObj[mergeKey]);\n                } else if (field instanceof ManyToMany) {\n                    // field is forward relation\n                    m2mRelations[mergeKey] = mergeObj[mergeKey];\n                    delete mergeObj[mergeKey];\n                }\n            } else if (virtualFields.hasOwnProperty(mergeKey)) {\n                const field = virtualFields[mergeKey];\n                if (field instanceof ManyToMany) {\n                    // field is backward relation\n                    m2mRelations[mergeKey] = mergeObj[mergeKey];\n                    delete mergeObj[mergeKey];\n                }\n            }\n        }\n\n        const mergedFields = {\n            ...this._fields,\n            ...mergeObj,\n        };\n\n        const updatedModel = new ThisModel(this._fields);\n        updatedModel._initFields(mergedFields); // eslint-disable-line no-underscore-dangle\n\n        // determine if model would have different related models after update\n        updatedModel._refreshMany2Many(m2mRelations); // eslint-disable-line no-underscore-dangle\n        const relationsEqual = Object.keys(m2mRelations).every(name => !arrayDiffActions(this[name], updatedModel[name])\n        );\n        const fieldsEqual = this.equals(updatedModel);\n\n        // only update fields if they have changed (referentially)\n        if (!fieldsEqual) {\n            this._initFields(mergedFields);\n        }\n\n        // only update many-to-many relationships if any reference has changed\n        if (!relationsEqual) {\n            this._refreshMany2Many(m2mRelations);\n        }\n\n        // only apply the update if a field or relationship has changed\n        if (!fieldsEqual || !relationsEqual) {\n            ThisModel.session.applyUpdate({\n                action: UPDATE,\n                query: getByIdQuery(this),\n                payload: mergeObj,\n            });\n        }\n    }\n\n    /**\n     * Updates {@link Model} instance attributes to reflect the\n     * database state in the current session.\n     * @return {undefined}\n     */\n    refreshFromState() {\n        this._initFields(this.ref);\n    }\n\n    /**\n     * Deletes the record for this {@link Model} instance.\n     * You'll still be able to access fields and values on the instance.\n     *\n     * @return {undefined}\n     */\n    delete() {\n        const ThisModel = this.getClass();\n        if (typeof ThisModel.session === 'undefined') {\n            throw new Error([\n                `Tried to delete a ${ThisModel.modelName} model instance without a session. `,\n                'You cannot call `.delete` on an instance that you did not receive from the database.',\n            ].join(''));\n        }\n\n        this._onDelete();\n        ThisModel.session.applyUpdate({\n            action: DELETE,\n            query: getByIdQuery(this),\n        });\n    }\n\n    /**\n     * Update many-many relations for model.\n     * @param relations\n     * @return undefined\n     * @private\n     */\n    _refreshMany2Many(relations) {\n        const ThisModel = this.getClass();\n        const { fields, virtualFields, modelName } = ThisModel;\n\n        Object.keys(relations).forEach((name) => {\n            const reverse = !fields.hasOwnProperty(name);\n            const field = virtualFields[name];\n            const values = relations[name];\n\n            if (!Array.isArray(values)) {\n                throw new TypeError(`Failed to resolve many-to-many relationship: ${modelName}[${name}] must be an array (passed: ${values})`);\n            }\n\n            const normalizedNewIds = values.map(normalizeEntity);\n            const uniqueIds = [...new Set(normalizedNewIds)];\n\n            if (normalizedNewIds.length !== uniqueIds.length) {\n                throw new Error(`Found duplicate id(s) when passing \"${normalizedNewIds}\" to ${ThisModel.modelName}.${name} value`);\n            }\n\n            const throughModelName = field.through || m2mName(ThisModel.modelName, name);\n            const ThroughModel = ThisModel.session[throughModelName];\n\n            let fromField;\n            let toField;\n\n            if (!reverse) {\n                ({ from: fromField, to: toField } = field.throughFields);\n            } else {\n                ({ from: toField, to: fromField } = field.throughFields);\n            }\n\n            const currentIds = ThroughModel.filter(through => through[fromField] === this[ThisModel.idAttribute]\n            ).toRefArray().map(ref => ref[toField]);\n\n            const diffActions = arrayDiffActions(currentIds, normalizedNewIds);\n\n            if (diffActions) {\n                const {\n                    delete: idsToDelete,\n                    add: idsToAdd,\n                } = diffActions;\n                if (idsToDelete.length > 0) {\n                    this[name].remove(...idsToDelete);\n                }\n                if (idsToAdd.length > 0) {\n                    this[name].add(...idsToAdd);\n                }\n            }\n        });\n    }\n\n    /**\n     * @return {undefined}\n     * @private\n     */\n    _onDelete() {\n        const { virtualFields } = this.getClass();\n        for (const key in virtualFields) { // eslint-disable-line\n            const field = virtualFields[key];\n            if (field instanceof ManyToMany) {\n                // Delete any many-to-many rows the entity is included in.\n                this[key].clear();\n            } else if (field instanceof ForeignKey) {\n                const relatedQs = this[key];\n                if (relatedQs.exists()) {\n                    relatedQs.update({ [field.relatedName]: null });\n                }\n            } else if (field instanceof OneToOne) {\n                // Set null to any foreign keys or one to ones pointed to\n                // this instance.\n                if (this[key] !== null) {\n                    this[key][field.relatedName] = null;\n                }\n            }\n        }\n    }\n\n    // DEPRECATED AND REMOVED METHODS\n\n    /**\n     * Returns a boolean indicating if an entity\n     * with the id `id` exists in the state.\n     *\n     * @param  {*}  id - a value corresponding to the id attribute of the {@link Model} class.\n     * @return {Boolean} a boolean indicating if entity with `id` exists in the state\n     * @deprecated Please use {@link Model.idExists} instead.\n     */\n    static hasId(id) {\n        console.warn('`Model.hasId` has been deprecated. Please use `Model.idExists` instead.');\n        return this.idExists(id);\n    }\n\n    /**\n     * @deprecated See the 0.9 migration guide on the GitHub repo.\n     * @throws {Error} Due to deprecation.\n     */\n    getNextState() {\n        throw new Error(\n            '`Model.prototype.getNextState` has been removed. See the 0.9 ' +\n            'migration guide on the GitHub repo.'\n        );\n    }\n};\n\nModel.fields = {\n    id: attr(),\n};\nModel.virtualFields = {};\nModel.querySetClass = QuerySet;\n\nexport default Model;\n","import reject from 'lodash/reject';\nimport filter from 'lodash/filter';\nimport orderBy from 'lodash/orderBy';\nimport sortBy from 'lodash/sortBy';\nimport ops from 'immutable-ops';\n\nimport {\n    FILTER, EXCLUDE, ORDER_BY,\n} from '../constants';\nimport { clauseFiltersByAttribute, clauseReducesResultSetSize } from '../utils';\n\nconst DEFAULT_TABLE_OPTIONS = {\n    idAttribute: 'id',\n    arrName: 'items',\n    mapName: 'itemsById',\n    fields: {},\n};\n\n// Input is the current max id and the new id passed to the create action.\n// Both may be undefined. The current max id in the case that this is the first Model\n// being created, and the new id if the id was not explicitly passed to the\n// database.\n//\n// Return value is the new max id and the id to use to create the new row.\n// If the id's are strings, the id must be passed explicitly every time.\n// In this case, the current max id will remain `NaN` due to `Math.max`, but that's fine.\nfunction idSequencer(_currMax, userPassedId) {\n    let currMax = _currMax;\n    let newMax;\n    let newId;\n\n    if (currMax === undefined) {\n        currMax = -1;\n    }\n\n    if (userPassedId === undefined) {\n        newMax = currMax + 1;\n        newId = newMax;\n    } else {\n        newMax = Math.max(currMax + 1, userPassedId);\n        newId = userPassedId;\n    }\n\n    return [\n        newMax, // new max id\n        newId, // id to use for row creation\n    ];\n}\n\n/**\n * Handles the underlying data structure for a {@link Model} class.\n */\nconst Table = class Table {\n    /**\n     * Creates a new {@link Table} instance.\n     * @param  {Object} userOpts - options to use.\n     * @param  {string} [userOpts.idAttribute=id] - the id attribute of the entity.\n     * @param  {string} [userOpts.arrName=items] - the state attribute where an array of\n     *                                             entity id's are stored\n     * @param  {string} [userOpts.mapName=itemsById] - the state attribute where the entity objects\n     *                                                 are stored in a id to entity object\n     *                                                 map.\n     * @param  {string} [userOpts.fields={}] - mapping of field key to {@link Field} object\n     */\n    constructor(userOpts) {\n        Object.assign(this, DEFAULT_TABLE_OPTIONS, userOpts);\n    }\n\n    /**\n     * Returns a reference to the object at index `id`\n     * in state `branch`.\n     *\n     * @param  {Object} branch - the state\n     * @param  {Number} id - the id of the object to get\n     * @return {Object|undefined} A reference to the raw object in the state or\n     *                            `undefined` if not found.\n     */\n    accessId(branch, id) {\n        return branch[this.mapName][id];\n    }\n\n    accessIds(branch, ids) {\n        const map = branch[this.mapName];\n        return ids.map(id => map[id]);\n    }\n\n    idExists(branch, id) {\n        return branch[this.mapName].hasOwnProperty(id);\n    }\n\n    accessIdList(branch) {\n        return branch[this.arrName];\n    }\n\n    accessList(branch) {\n        return this.accessIds(branch, this.accessIdList(branch));\n    }\n\n    getMaxId(branch) {\n        return this.getMeta(branch, 'maxId');\n    }\n\n    setMaxId(tx, branch, newMaxId) {\n        return this.setMeta(tx, branch, 'maxId', newMaxId);\n    }\n\n    nextId(id) {\n        return id + 1;\n    }\n\n    /**\n     * Returns the default state for the data structure.\n     * @return {Object} The default state for this {@link ORM} instance's data structure\n     */\n    getEmptyState() {\n        const pkIndex = {\n            [this.arrName]: [],\n            [this.mapName]: {},\n        };\n        const attrIndexes = Object.keys(this.fields)\n            .filter(attr => attr !== this.idAttribute)\n            .filter(attr => this.fields[attr].index)\n            .reduce((indexes, attr) => ({\n                ...indexes,\n                [attr]: {},\n            }), {});\n        return {\n            ...pkIndex,\n            indexes: attrIndexes,\n            meta: {},\n        };\n    }\n\n    setMeta(tx, branch, key, value) {\n        const { batchToken, withMutations } = tx;\n        if (withMutations) {\n            const res = ops.mutable.setIn(['meta', key], value, branch);\n            return res;\n        }\n\n        return ops.batch.setIn(batchToken, ['meta', key], value, branch);\n    }\n\n    getMeta(branch, key) {\n        return branch.meta[key];\n    }\n\n    query(branch, clauses) {\n        if (clauses.length === 0) {\n            return this.accessList(branch);\n        }\n\n        const { idAttribute } = this;\n\n        const optimallyOrderedClauses = sortBy(clauses, (clause) => {\n            if (clauseFiltersByAttribute(clause, idAttribute)) {\n                return 1;\n            }\n\n            if (clauseReducesResultSetSize(clause)) {\n                return 2;\n            }\n\n            return 3;\n        });\n\n        const reducer = (rows, clause) => {\n            const { type, payload } = clause;\n            if (!rows) {\n                /**\n                 * First time this reducer is called during query.\n                 * This is where we apply query optimizations.\n                 */\n                if (clauseFiltersByAttribute(clause, idAttribute)) {\n                    /**\n                     * Payload specified a primary key. Use PK index\n                     * to look up the single row identified by the PK.\n                     */\n                    const id = payload[idAttribute];\n                    return this.idExists(branch, id)\n                        ? [this.accessId(branch, id)]\n                        : [];\n                }\n                if (type === FILTER && typeof payload === 'object') {\n                    const indexes = Object.entries(branch.indexes);\n                    const accessedIndexes = [];\n                    const indexAttrs = [];\n                    indexes.forEach(([attr, index]) => {\n                        if (clauseFiltersByAttribute(clause, attr)) {\n                            /**\n                            * Payload specified an indexed attribute. Use index\n                            * to potentially decrease amount of accessed rows.\n                            */\n                            if (index.hasOwnProperty(payload[attr])) {\n                                accessedIndexes.push(index[payload[attr]]);\n                                indexAttrs.push(attr);\n                            }\n                        }\n                    });\n                    /**\n                     * Calculate set of unique PK values corresponding to each\n                     * foreign key's attribute value. Then retrieve all those rows.\n                     */\n                    if (accessedIndexes.length) {\n                        const lastIndex = accessedIndexes.pop();\n                        const indexedIds = accessedIndexes.reduce((result, index) => {\n                            const indexSet = new Set(index);\n                            return result.filter(Set.prototype.has, indexSet);\n                        }, lastIndex);\n                        const newPayload = Object.keys(payload)\n                            .reduce((withoutIndexAttrs, filterAttr) => {\n                                if (!indexAttrs.includes(filterAttr)) {\n                                    withoutIndexAttrs[filterAttr] = payload[filterAttr];\n                                }\n                                return withoutIndexAttrs;\n                            }, {});\n                        if (Object.keys(newPayload).length === 0) {\n                            /**\n                             * No need to filter these rows any further.\n                             * The used indexes satisfy this clause's conditions.\n                             */\n                            return this.accessIds(branch, indexedIds);\n                        }\n                        return reducer(this.accessIds(branch, indexedIds), {\n                            ...clause,\n                            payload: newPayload,\n                        });\n                    }\n                }\n\n                // Give up optimization: Retrieve all rows (full table scan).\n                return reducer(this.accessList(branch), clause);\n            }\n\n            switch (type) {\n            case FILTER: {\n                return filter(rows, payload);\n            }\n            case EXCLUDE: {\n                return reject(rows, payload);\n            }\n            case ORDER_BY: {\n                const [iteratees, orders] = payload;\n                return orderBy(rows, iteratees, orders);\n            }\n            default:\n                return rows;\n            }\n        };\n\n        return optimallyOrderedClauses.reduce(reducer, undefined);\n    }\n\n    /**\n     * Returns the data structure including a new object `entry`\n     * @param  {Object} tx - transaction info\n     * @param  {Object} branch - the data structure state\n     * @param  {Object} entry - the object to insert\n     * @return {Object} an object with two keys: `state` and `created`.\n     *                  `state` is the new table state and `created` is the\n     *                  row that was created.\n     */\n    insert(tx, branch, entry) {\n        const { batchToken, withMutations } = tx;\n\n        const hasId = entry.hasOwnProperty(this.idAttribute);\n\n        let workingState = branch;\n\n        // This will not affect string id's.\n        const [newMaxId, id] = idSequencer(this.getMaxId(branch), entry[this.idAttribute]);\n        workingState = this.setMaxId(tx, branch, newMaxId);\n\n        const finalEntry = hasId\n            ? entry\n            : ops.batch.set(batchToken, this.idAttribute, id, entry);\n\n        const indexesToAppendTo = Object.keys(workingState.indexes).reduce((values, fkAttr) => {\n            if (!entry.hasOwnProperty(fkAttr)) return values;\n            if (entry[fkAttr] === null) return values;\n            values.push([fkAttr, entry[fkAttr]]);\n            return values;\n        }, []);\n\n\n        if (withMutations) {\n            ops.mutable.push(id, workingState[this.arrName]);\n            ops.mutable.set(id, finalEntry, workingState[this.mapName]);\n            // add id to indexes\n            indexesToAppendTo.forEach(([attr, value]) => {\n                const attrIndex = workingState.indexes[attr];\n                if (attrIndex.hasOwnProperty(value)) {\n                    ops.mutable.push(id, attrIndex[value]);\n                } else {\n                    ops.mutable.set(value, [id], attrIndex);\n                }\n            });\n            return {\n                state: workingState,\n                created: finalEntry,\n            };\n        }\n\n        const nextIndexes = ops.batch.merge(\n            batchToken,\n            indexesToAppendTo\n                .reduce((indexMap, [attr, value]) => {\n                    indexMap[attr] = ops.batch.merge(\n                        batchToken,\n                        {\n                            [value]: ops.batch.push(\n                                batchToken,\n                                id,\n                                indexMap[attr][value] || []\n                            ),\n                        },\n                        indexMap[attr]\n                    );\n                    return indexMap;\n                }, { ...workingState.indexes }),\n            workingState.indexes\n        );\n\n        const nextState = ops.batch.merge(batchToken, {\n            [this.arrName]: ops.batch.push(batchToken, id, workingState[this.arrName]),\n            [this.mapName]: ops.batch.merge(batchToken, {\n                [id]: finalEntry,\n            }, workingState[this.mapName]),\n            indexes: nextIndexes,\n        }, workingState);\n\n        return {\n            state: nextState,\n            created: finalEntry,\n        };\n    }\n\n    /**\n     * Returns the data structure with objects where `rows`\n     * are merged with `mergeObj`.\n     *\n     * @param  {Object} tx - transaction info\n     * @param  {Object} branch - the data structure state\n     * @param  {Object[]} rows - rows to update\n     * @param  {Object} mergeObj - The object to merge with each row.\n     * @return {Object}\n     */\n    update(tx, branch, rows, mergeObj) {\n        const { batchToken, withMutations } = tx;\n\n        const mergeObjInto = (row) => {\n            const merge = withMutations ? ops.mutable.merge : ops.batch.merge(batchToken);\n            return merge(mergeObj, row);\n        };\n\n        const set = withMutations ? ops.mutable.set : ops.batch.set(batchToken);\n\n        const indexedAttrs = Object.keys(branch.indexes)\n            .filter(attr => mergeObj.hasOwnProperty(attr));\n        const indexIdsToAdd = [];\n        const indexIdsToDelete = [];\n\n        const nextMap = rows.reduce((map, row) => {\n            const prevAttrValues = indexedAttrs.reduce((valueMap, attr) => ({\n                ...valueMap,\n                [attr]: row[attr],\n            }), {});\n            const result = mergeObjInto(row);\n            const nextAttrValues = indexedAttrs.reduce((valueMap, attr) => ({\n                ...valueMap,\n                [attr]: result[attr],\n            }), {});\n            const id = result[this.idAttribute];\n            const nextRow = set(id, result, map);\n            indexedAttrs.forEach((attr) => {\n                const { [attr]: prevValue } = prevAttrValues;\n                const { [attr]: nextValue } = nextAttrValues;\n                if (prevValue === nextValue) {\n                    // attribute has not changed, no need to update any index\n                    return;\n                }\n                if (prevValue !== null) {\n                    // remove id from attribute's index for its old value\n                    indexIdsToDelete.push([attr, prevValue, id]);\n                }\n                if (nextValue !== null) {\n                    // add id to attribute's index for its new value\n                    indexIdsToAdd.push([attr, nextValue, id]);\n                }\n            });\n            return nextRow;\n        }, branch[this.mapName]);\n\n        let nextIndexes = branch.indexes;\n        if (withMutations) {\n            indexIdsToDelete.forEach(([attr, value, id]) => {\n                const arr = nextIndexes[attr][value];\n                const idx = arr.indexOf(id);\n                if (idx !== -1) {\n                    ops.mutable.splice(idx, 1, [], arr);\n                }\n            });\n            indexIdsToAdd.forEach(([attr, value, id]) => {\n                ops.mutable.push(id, nextIndexes[attr][value]);\n            });\n        } else {\n            if (indexIdsToAdd.length) {\n                nextIndexes = ops.batch.merge(\n                    batchToken,\n                    indexIdsToAdd.reduce((indexMap, [attr, value, id]) => {\n                        indexMap[attr] = ops.batch.merge(\n                            batchToken,\n                            {\n                                [value]: ops.batch.push(\n                                    batchToken,\n                                    id,\n                                    indexMap[attr][value] || []\n                                ),\n                            },\n                            indexMap[attr]\n                        );\n                        return indexMap;\n                    }, { ...nextIndexes }),\n                    nextIndexes\n                );\n            }\n            if (indexIdsToDelete.length) {\n                nextIndexes = ops.batch.merge(\n                    batchToken,\n                    indexIdsToDelete.reduce((indexMap, [attr, value, id]) => {\n                        indexMap[attr] = ops.batch.merge(\n                            batchToken,\n                            {\n                                [value]: ops.batch.filter(\n                                    batchToken,\n                                    rowId => rowId !== id,\n                                    indexMap[attr][value] || []\n                                ),\n                            },\n                            indexMap[attr]\n                        );\n                        return indexMap;\n                    }, { ...nextIndexes }),\n                    nextIndexes\n                );\n            }\n        }\n\n        return ops.batch.merge(batchToken, {\n            [this.mapName]: nextMap,\n            indexes: nextIndexes,\n        }, branch);\n    }\n\n    /**\n     * Returns the data structure without rows `rows`.\n     * @param  {Object} tx - transaction info\n     * @param  {Object} branch - the data structure state\n     * @param  {Object[]} rows - rows to update\n     * @return {Object} the data structure without ids in `idsToDelete`.\n     */\n    delete(tx, branch, rows) {\n        const { batchToken, withMutations } = tx;\n\n        const { arrName, mapName } = this;\n        const arr = branch[arrName];\n\n        const idsToDelete = rows.map(row => row[this.idAttribute]);\n        if (withMutations) {\n            idsToDelete.forEach((id) => {\n                const idx = arr.indexOf(id);\n                if (idx !== -1) {\n                    ops.mutable.splice(idx, 1, [], arr);\n                }\n\n                ops.mutable.omit(id, branch[mapName]);\n            });\n            // delete ids from all indexes\n            Object.values(branch.indexes).forEach(attrIndex => (\n                Object.values(attrIndex).forEach(valueIndex => (\n                    idsToDelete.forEach((id) => {\n                        const idx = valueIndex.indexOf(id);\n                        if (idx !== -1) {\n                            ops.mutable.splice(idx, 1, [], valueIndex);\n                        }\n                    })\n                ))\n            ));\n            return branch;\n        }\n\n        const nextIndexes = ops.batch.merge(\n            batchToken,\n            Object.entries(branch.indexes).reduce((indexMap, [attr, attrIndex]) => {\n                indexMap[attr] = ops.batch.merge(\n                    batchToken,\n                    Object.entries(attrIndex).reduce((attrIndexMap, [value, valueIndex]) => {\n                        attrIndexMap[value] = ops.batch.filter(\n                            batchToken,\n                            id => !idsToDelete.includes(id),\n                            valueIndex\n                        );\n                        return attrIndexMap;\n                    }, { ...indexMap[attr] }),\n                    indexMap[attr]\n                );\n                return indexMap;\n            }, { ...branch.indexes }),\n            branch.indexes\n        );\n\n        return ops.batch.merge(batchToken, {\n            [arrName]: ops.batch.filter(\n                batchToken,\n                id => !idsToDelete.includes(id),\n                branch[arrName],\n            ),\n            [mapName]: ops.batch.omit(\n                batchToken,\n                idsToDelete,\n                branch[mapName],\n            ),\n            indexes: ops.batch.merge(\n                batchToken,\n                nextIndexes,\n                branch.indexes,\n            ),\n        }, branch);\n    }\n};\n\nexport default Table;\n","import ops from 'immutable-ops';\n\nimport {\n    CREATE, UPDATE, DELETE, SUCCESS,\n} from '../constants';\n\nimport Table from './Table';\n\n\nfunction replaceTableState(tableName, newTableState, tx, state) {\n    const { batchToken, withMutations } = tx;\n\n    if (withMutations) {\n        state[tableName] = newTableState;\n        return state;\n    }\n\n    return ops.batch.set(batchToken, tableName, newTableState, state);\n}\n\nfunction query(tables, querySpec, state) {\n    const { table: tableName, clauses } = querySpec;\n    const table = tables[tableName];\n    const rows = table.query(state[tableName], clauses);\n    return {\n        rows,\n    };\n}\n\nfunction update(tables, updateSpec, tx, state) {\n    const { action, payload } = updateSpec;\n\n    let tableName;\n    let nextTableState;\n    let resultPayload;\n\n    if (action === CREATE) {\n        ({ table: tableName } = updateSpec);\n        const table = tables[tableName];\n        const currTableState = state[tableName];\n        const result = table.insert(tx, currTableState, payload);\n        nextTableState = result.state;\n        resultPayload = result.created;\n    } else {\n        const { query: querySpec } = updateSpec;\n        ({ table: tableName } = querySpec);\n        const { rows } = query(tables, querySpec, state);\n\n        const table = tables[tableName];\n        const currTableState = state[tableName];\n\n        if (action === UPDATE) {\n            nextTableState = table.update(tx, currTableState, rows, payload);\n            // return updated rows\n            resultPayload = query(tables, querySpec, state).rows;\n        } else if (action === DELETE) {\n            nextTableState = table.delete(tx, currTableState, rows);\n            // return original rows that we just deleted\n            resultPayload = rows;\n        } else {\n            throw new Error(`Database received unknown update type: ${action}`);\n        }\n    }\n\n    const nextDBState = replaceTableState(tableName, nextTableState, tx, state);\n    return {\n        status: SUCCESS,\n        state: nextDBState,\n        payload: resultPayload,\n    };\n}\n\n\nexport function createDatabase(schemaSpec) {\n    const { tables: tableSpecs } = schemaSpec;\n    const tables = Object.entries(tableSpecs)\n        .reduce((map, [tableName, tableSpec]) => ({\n            ...map,\n            [tableName]: new Table(tableSpec),\n        }), {});\n\n    const getEmptyState = () => (\n        Object.entries(tables)\n            .reduce((map, [tableName, table]) => ({\n                ...map,\n                [tableName]: table.getEmptyState(),\n            }), {})\n    );\n\n    return {\n        getEmptyState,\n        query: query.bind(null, tables),\n        update: update.bind(null, tables),\n        // Used to inspect the schema.\n        describe: tableName => tables[tableName],\n    };\n}\n\nexport default createDatabase;\n","const defaultEqualityCheck = (a, b) => a === b;\nexport const eqCheck = defaultEqualityCheck;\n\nconst argsAreEqual = (lastArgs, nextArgs, equalityCheck) => (\n    nextArgs.every((arg, index) => (\n        equalityCheck(arg, lastArgs[index])\n    ))\n);\n\nconst rowsAreEqual = (ids, rowsA, rowsB) => (\n    ids.every(id => rowsA[id] === rowsB[id])\n);\n\nconst accessedModelInstancesAreEqual = (previous, ormState, orm) => {\n    const {\n        accessedInstances,\n    } = previous;\n\n    return Object.entries(accessedInstances).every(([modelName, instances]) => {\n        // if the entire table has not been changed, we have nothing to do\n        if (previous.ormState[modelName] === ormState[modelName]) {\n            return true;\n        }\n\n        const { mapName } = orm.getDatabase().describe(modelName);\n\n        const { [mapName]: previousRows } = previous.ormState[modelName];\n        const { [mapName]: rows } = ormState[modelName];\n\n        const accessedIds = Object.keys(instances);\n        return rowsAreEqual(accessedIds, previousRows, rows);\n    });\n};\n\nconst accessedIndexesAreEqual = (previous, ormState) => {\n    const {\n        accessedIndexes,\n    } = previous;\n\n    return Object.entries(accessedIndexes).every(([modelName, indexes]) => (\n        Object.entries(indexes).every(([column, values]) => (\n            values.every(value => (\n                previous.ormState[modelName].indexes[column][value]\n                    === ormState[modelName].indexes[column][value]\n            ))\n        ))\n    ));\n};\n\nconst fullTableScannedModelsAreEqual = (previous, ormState) => (\n    previous.fullTableScannedModels.every(modelName => (\n        previous.ormState[modelName]\n            === ormState[modelName]\n    ))\n);\n\n/**\n * A memoizer to use with redux-orm\n * selectors. When the memoized function is first run,\n * the memoizer will remember the models that are accessed\n * during that function run.\n *\n * On subsequent runs, the memoizer will check if those\n * models' states have changed compared to the previous run.\n *\n * Memoization algorithm operates like this:\n *\n * 1. Has the selector been run before? If not, go to 6.\n *\n * 2. If the selector has other input selectors in addition to the\n *    ORM state selector, check their results for equality with the previous results.\n *    If they aren't equal, go to 6.\n *\n * 3. Some filter queries may have required scanning entire tables during the last run.\n *    If any of those tables have changed, go to 6.\n *\n * 4. Check which foreign key indexes the database has used to speed up queries\n *    during the last run. If any have changed, go to 6.\n *\n * 5. Check which Model's instances the selector has accessed during the last run.\n *    Check for equality with each of those states versus their states in the\n *    previous ORM state. If all of them are equal, return the previous result.\n *\n * 6. Run the selector. Check the Session object used by the selector for\n *    which Model's states were accessed, and merge them with the previously\n *    saved information about accessed models (if-else branching can change\n *    which models are accessed on different inputs). Save the ORM state and\n *    other arguments the selector was called with, overriding previously\n *    saved values. Save the selector result. Return the selector result.\n *\n * @private\n * @param  {Function} func - function to memoize\n * @param  {Function} argEqualityCheck - equality check function to use with normal\n *                                       selector args\n * @param  {ORM} orm - a redux-orm ORM instance\n * @return {Function} `func` memoized.\n */\nexport function memoize(func, argEqualityCheck = defaultEqualityCheck, orm) {\n    const previous = {\n        /* Result of the previous function call */\n        result: null,\n        /* Arguments to the previous function call (excluding ORM state) */\n        args: null,\n        /**\n         * Snapshot of the previous database.\n         *\n         * Lets us know how the tables looked like\n         * during the previous function call.\n         */\n        ormState: null,\n        /**\n         * Names of models whose tables have been scanned completely\n         * during previous function call (contains only model names)\n         * Format example: ['Book']\n         */\n        fullTableScannedModels: [],\n        /**\n         * Map of which model instances have been accessed\n         * during previous function call.\n         * Contains only PKs of accessed instances.\n         * Format example: { Book: { 1: true, 3: true } }\n         */\n        accessedInstances: {},\n        /**\n         * Map of which attribute indexes have been accessed\n         * during previous function call.\n         * Contains only attributes that were actually filtered on.\n         * Author.withId(3).books would add 3 to the authorId index below.\n         * Format example: { Book: { authorId: [1, 2], publisherId: [5] } }\n         */\n        accessedIndexes: {},\n    };\n\n    return (...stateAndArgs) => {\n        /**\n         * The first argument to this function needs to be\n         * the ORM's reducer state in the user's Redux store.\n         */\n        const [ormState, ...args] = stateAndArgs;\n\n        const selectorWasCalledBefore = (\n            previous.args &&\n            previous.ormState\n        );\n\n        if (\n            selectorWasCalledBefore &&\n            argsAreEqual(previous.args, args, argEqualityCheck) &&\n            fullTableScannedModelsAreEqual(previous, ormState) &&\n            accessedIndexesAreEqual(previous, ormState) &&\n            accessedModelInstancesAreEqual(previous, ormState, orm)\n        ) {\n            /**\n             * None of this selector's dependencies have changed\n             * since the last time that we called it.\n             */\n            return previous.result;\n        }\n\n        /**\n         * The previous result is no longer valid.\n         * Begin updating cached values, starting with\n         * the arguments that we will pass to the selector.\n         */\n        previous.args = args;\n\n        /**\n         * Start a session so that the selector can access the database.\n         * Make this session immutable. This way we can find out if\n         * the operations that the selector performs are cacheable.\n         */\n        const session = orm.session(ormState);\n        previous.ormState = ormState;\n\n        /* This is where we call the actual function */\n        const result = func(...[session, ...args]);\n        previous.result = result;\n\n        /* Rows retrieved during function call */\n        previous.accessedInstances = session.accessedModelInstances;\n        /* Foreign key indexes that were used to speed up queries */\n        previous.accessedIndexes = session.accessedIndexes;\n        /* Tables that had to be scanned completely */\n        previous.fullTableScannedModels = session.fullTableScannedModels;\n\n        return result;\n    };\n}\n","import { createSelectorCreator } from 'reselect';\n\nimport { memoize } from './memoize';\n\n/**\n * @module redux\n */\n\n/**\n * Calls all models' reducers if they exist.\n * @return {undefined}\n */\nexport function defaultUpdater(session, action) {\n    session.sessionBoundModels.forEach((modelClass) => {\n        if (typeof modelClass.reducer === 'function') {\n            // This calls this.applyUpdate to update this.state\n            modelClass.reducer(action, modelClass, session);\n        }\n    });\n}\n\n\n/**\n * Call the returned function to pass actions to Redux-ORM.\n *\n * @global\n *\n * @param {ORM} orm - the ORM instance.\n * @param {Function} [updater] - the function updating the ORM state based on the given action.\n * @return {Function} reducer that will update the ORM state.\n */\nexport function createReducer(orm, updater = defaultUpdater) {\n    return (state, action) => {\n        const session = orm.session(state || orm.getEmptyState());\n        updater(session, action);\n        return session.state;\n    };\n}\n\n\n/**\n * Returns a memoized selector based on passed arguments.\n * This is similar to `reselect`'s `createSelector`,\n * except you can also pass a single function to be memoized.\n *\n * If you pass multiple functions, the format will be the\n * same as in `reselect`. The last argument is the selector\n * function and the previous are input selectors.\n *\n * When you use this method to create a selector, the returned selector\n * expects the whole `redux-orm` state branch as input. In the selector\n * function that you pass as the last argument, you will receive a\n * `session` argument (a `Session` instance) followed by any\n * input arguments, like in `reselect`.\n *\n * This is an example selector:\n *\n * ```javascript\n * // orm is an instance of ORM\n * const bookSelector = createSelector(orm, session => {\n *     return session.Book.map(book => {\n *         return Object.assign({}, book.ref, {\n *             authors: book.authors.map(author => author.name),\n *             genres: book.genres.map(genre => genre.name),\n *         });\n *     });\n * });\n * ```\n *\n * redux-orm uses a special memoization function to avoid recomputations.\n *\n * Everytime a selector runs, this function records which instances\n * of your `Model`s were accessed.<br>\n * On subsequent runs, the selector first checks if the previously\n * accessed instances or `args` have changed in any way:\n * <ul>\n *     <li>If yes, the selector calls the function you passed to it.</li>\n *     <li>If not, it just returns the previous result\n *         (unless you call it for the first time).</li>\n * </ul>\n *\n * This way you can use the `PureRenderMixin` in your React components\n * for performance gains.\n *\n * @global\n *\n * @param {ORM} orm - the ORM instance\n * @param  {...Function} args - zero or more input selectors\n *                              and the selector function.\n * @return {Function} memoized selector\n */\nexport function createSelector(orm, ...args) {\n    if (args.length === 1) {\n        return memoize(args[0], undefined, orm);\n    }\n\n    return createSelectorCreator(memoize, undefined, orm)(...args);\n}\n","import Session from './Session';\nimport Model from './Model';\nimport { createDatabase as defaultCreateDatabase } from './db';\nimport {\n    ForeignKey,\n    ManyToMany,\n    attr,\n} from './fields';\n\nimport {\n    createReducer,\n    createSelector,\n} from './redux';\n\nimport {\n    m2mName,\n    attachQuerySetMethods,\n    m2mToFieldName,\n    m2mFromFieldName,\n    warnDeprecated,\n} from './utils';\n\nconst ORM_DEFAULTS = {\n    createDatabase: defaultCreateDatabase,\n};\n\nconst RESERVED_TABLE_OPTIONS = [\n    'indexes',\n    'meta',\n];\nconst isReservedTableOption = word => RESERVED_TABLE_OPTIONS.includes(word);\n\n/**\n * ORM - the Object Relational Mapper.\n *\n * Use instances of this class to:\n *\n * - Register your {@link Model} classes using {@link ORM#register}\n * - Get the empty state for the underlying database with {@link ORM#getEmptyState}\n * - Start an immutable database session with {@link ORM#session}\n * - Start a mutating database session with {@link ORM#mutableSession}\n *\n * Internally, this class handles generating a schema specification from models\n * to the database.\n */\nexport class ORM {\n    /**\n     * Creates a new ORM instance.\n     */\n    constructor(opts) {\n        const { createDatabase } = Object.assign({}, ORM_DEFAULTS, (opts || {}));\n        this.createDatabase = createDatabase;\n        this.registry = [];\n        this.implicitThroughModels = [];\n        this.installedFields = {};\n    }\n\n    /**\n     * Registers a {@link Model} class to the ORM.\n     *\n     * If the model has declared any ManyToMany fields, their\n     * through models will be generated and registered with\n     * this call, unless a custom through model has been specified.\n     *\n     * @param  {...Model} model - a {@link Model} class to register\n     * @return {undefined}\n     */\n    register(...models) {\n        models.forEach((model) => {\n            if (model.modelName === undefined) {\n                throw new Error('A model was passed that doesn\\'t have a modelName set');\n            }\n\n            model.invalidateClassCache();\n\n            this.registerManyToManyModelsFor(model);\n            this.registry.push(model);\n        });\n    }\n\n    registerManyToManyModelsFor(model) {\n        const { fields } = model;\n        const thisModelName = model.modelName;\n\n        Object.entries(fields).forEach(([fieldName, fieldInstance]) => {\n            if (!(fieldInstance instanceof ManyToMany)) {\n                return;\n            }\n\n            let toModelName;\n            if (fieldInstance.toModelName === 'this') {\n                toModelName = thisModelName;\n            } else {\n                toModelName = fieldInstance.toModelName; // eslint-disable-line prefer-destructuring\n            }\n\n            const selfReferencing = thisModelName === toModelName;\n            const fromFieldName = m2mFromFieldName(thisModelName);\n            const toFieldName = m2mToFieldName(toModelName);\n\n            if (fieldInstance.through) {\n                if (selfReferencing && !fieldInstance.throughFields) {\n                    throw new Error(\n                        'Self-referencing many-to-many relationship at ' +\n                        `\"${thisModelName}.${fieldName}\" using custom ` +\n                        `model \"${fieldInstance.through}\" has no ` +\n                        'throughFields key. Cannot determine which ' +\n                        'fields reference the instances partaking ' +\n                        'in the relationship.'\n                    );\n                }\n            } else {\n                const Through = class ThroughModel extends Model {};\n\n                Through.modelName = m2mName(thisModelName, fieldName);\n\n                const PlainForeignKey = class ThroughForeignKeyField extends ForeignKey {\n                    get installsBackwardsVirtualField() {\n                        return false;\n                    }\n\n                    get installsBackwardsDescriptor() {\n                        return false;\n                    }\n                };\n                const ForeignKeyClass = selfReferencing\n                    ? PlainForeignKey\n                    : ForeignKey;\n                Through.fields = {\n                    id: attr(),\n                    [fromFieldName]: new ForeignKeyClass(thisModelName),\n                    [toFieldName]: new ForeignKeyClass(toModelName),\n                };\n\n                Through.invalidateClassCache();\n                this.implicitThroughModels.push(Through);\n            }\n        });\n    }\n\n    /**\n     * Gets a {@link Model} class by its name from the registry.\n     * @param  {string} modelName - the name of the {@link Model} class to get\n     * @throws If {@link Model} class is not found.\n     * @return {Model} the {@link Model} class, if found\n     */\n    get(modelName) {\n        const allModels = this.registry.concat(this.implicitThroughModels);\n        const found = Object.values(allModels).find(\n            model => model.modelName === modelName\n        );\n\n        if (typeof found === 'undefined') {\n            throw new Error(`Did not find model ${modelName} from registry.`);\n        }\n        return found;\n    }\n\n    getModelClasses() {\n        this._setupModelPrototypes(this.registry);\n        this._setupModelPrototypes(this.implicitThroughModels);\n        return this.registry.concat(this.implicitThroughModels);\n    }\n\n    generateSchemaSpec() {\n        const models = this.getModelClasses();\n        const tables = models.reduce((spec, modelClass) => {\n            const tableName = modelClass.modelName;\n            const tableSpec = modelClass._getTableOpts(); // eslint-disable-line no-underscore-dangle\n            Object.keys(tableSpec).forEach((key) => {\n                if (!isReservedTableOption(key)) return;\n                throw new Error(`Reserved keyword \\`${key}\\` used in ${tableName}.options.`);\n            });\n            spec[tableName] = Object.assign({}, { fields: modelClass.fields }, tableSpec);\n            return spec;\n        }, {});\n        return { tables };\n    }\n\n    getDatabase() {\n        if (!this.db) {\n            this.db = this.createDatabase(this.generateSchemaSpec());\n        }\n        return this.db;\n    }\n\n    /**\n     * Returns the empty database state.\n     * @return {Object} the empty state\n     */\n    getEmptyState() {\n        return this.getDatabase().getEmptyState();\n    }\n\n    /**\n     * Begins an immutable database session.\n     *\n     * @param  {Object} state  - the state the database manages\n     * @return {Session} a new {@link Session} instance\n     */\n    session(state) {\n        return new Session(this, this.getDatabase(), state);\n    }\n\n    /**\n     * Begins a mutable database session.\n     *\n     * @param  {Object} state  - the state the database manages\n     * @return {Session} a new {@link Session} instance\n     */\n    mutableSession(state) {\n        return new Session(this, this.getDatabase(), state, true);\n    }\n\n    /**\n     * @private\n     */\n    _setupModelPrototypes(models) {\n        models.forEach((model) => {\n            if (!model.isSetUp) {\n                const { fields, modelName, querySetClass } = model;\n                Object.entries(fields).forEach(([fieldName, field]) => {\n                    if (!this._isFieldInstalled(modelName, fieldName)) {\n                        this._installField(field, fieldName, model);\n                        this._setFieldInstalled(modelName, fieldName);\n                    }\n                });\n                attachQuerySetMethods(model, querySetClass);\n                model.isSetUp = true;\n            }\n        });\n    }\n\n    /**\n     * @private\n     */\n    _isFieldInstalled(modelName, fieldName) {\n        return this.installedFields.hasOwnProperty(modelName)\n            ? !!this.installedFields[modelName][fieldName]\n            : false;\n    }\n\n    /**\n     * @private\n     */\n    _setFieldInstalled(modelName, fieldName) {\n        if (!this.installedFields.hasOwnProperty(modelName)) {\n            this.installedFields[modelName] = {};\n        }\n        this.installedFields[modelName][fieldName] = true;\n    }\n\n    /**\n     * Installs a field on a model and its related models if necessary.\n     * @private\n     */\n    _installField(field, fieldName, model) {\n        const FieldInstaller = field.installerClass;\n        (new FieldInstaller({\n            field,\n            fieldName,\n            model,\n            orm: this,\n        })).run();\n    }\n\n    // DEPRECATED AND REMOVED METHODS\n\n    /**\n     * @deprecated Use {@link ORM#mutableSession} instead.\n     */\n    withMutations(state) {\n        warnDeprecated(\n            '`ORM.prototype.withMutations` has been deprecated. ' +\n            'Use `ORM.prototype.mutableSession` instead.'\n        );\n        return this.mutableSession(state);\n    }\n\n    /**\n     * @deprecated Use {@link ORM#session} instead.\n     */\n    from(state) {\n        warnDeprecated(\n            '`ORM.prototype.from` has been deprecated. ' +\n            'Use `ORM.prototype.session` instead.'\n        );\n        return this.session(state);\n    }\n\n    /**\n     * @deprecated Access {@link Session#state} instead.\n     */\n    reducer() {\n        warnDeprecated(\n            '`ORM.prototype.reducer` has been deprecated. Access ' +\n            'the `Session.prototype.state` property instead.'\n        );\n        return createReducer(this);\n    }\n\n    /**\n     * @deprecated Use `import { createSelector } from \"redux-orm\"` instead.\n     */\n    createSelector(...args) {\n        warnDeprecated(\n            '`ORM.prototype.createSelector` has been deprecated. ' +\n            'Import `createSelector` from Redux-ORM instead.'\n        );\n        return createSelector(this, ...args);\n    }\n\n    /**\n     * @deprecated Use {@link ORM#getEmptyState} instead.\n     */\n    getDefaultState() {\n        warnDeprecated(\n            '`ORM.prototype.getDefaultState` has been deprecated. Use ' +\n            '`ORM.prototype.getEmptyState` instead.'\n        );\n        return this.getEmptyState();\n    }\n\n    /**\n     * @deprecated Define a Model class instead.\n     */\n    define() {\n        throw new Error(\n            '`ORM.prototype.define` has been removed. Please define a Model class.'\n        );\n    }\n}\n\nexport function DeprecatedSchema() {\n    throw new Error(\n        'Schema has been renamed to ORM. Please import ORM instead of Schema ' +\n        'from Redux-ORM.'\n    );\n}\n\nexport default ORM;\n","import QuerySet from './QuerySet';\nimport Model from './Model';\nimport { DeprecatedSchema, ORM } from './ORM';\nimport Session from './Session';\nimport {\n    createReducer,\n    createSelector,\n} from './redux';\nimport {\n    ForeignKey,\n    ManyToMany,\n    OneToOne,\n    fk,\n    many,\n    oneToOne,\n    attr,\n    Attribute,\n} from './fields';\n\nconst Schema = DeprecatedSchema;\n\nconst Backend = function RemovedBackend() {\n    throw new Error(\n        'Having a custom Backend instance is now unsupported. ' +\n        'Documentation for database customization is upcoming, for now ' +\n        'please look at the db folder in the source.'\n    );\n};\n\nexport {\n    Attribute,\n    QuerySet,\n    Model,\n    ORM,\n    Schema,\n    Backend,\n    Session,\n    ForeignKey,\n    ManyToMany,\n    OneToOne,\n    fk,\n    many,\n    attr,\n    oneToOne,\n    createReducer,\n    createSelector,\n};\n\nexport default Model;\n"],"sourceRoot":""}